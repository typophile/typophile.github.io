<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Fractional Advance Widths vs. Advance Phantom Point | Typophile Archive</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="">
    <meta name="generator" content="Hugo 0.91.2" />
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <link href="/style.css" rel="stylesheet">

    <meta property="og:title" content="Fractional Advance Widths vs. Advance Phantom Point" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://typophile.github.io/node/114094/" /><meta property="article:section" content="node" />
<meta property="article:published_time" content="2014-02-11T09:39:21+00:00" />
<meta property="article:modified_time" content="2014-02-11T09:39:21+00:00" />

<meta itemprop="name" content="Fractional Advance Widths vs. Advance Phantom Point">
<meta itemprop="description" content=""><meta itemprop="datePublished" content="2014-02-11T09:39:21+00:00" />
<meta itemprop="dateModified" content="2014-02-11T09:39:21+00:00" />
<meta itemprop="wordCount" content="0">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Fractional Advance Widths vs. Advance Phantom Point"/>
<meta name="twitter:description" content=""/>

  </head>

  <body class="ma0">

      <header>
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container">
      <a class="navbar-brand" href="/">Typophile Archive</a>
      <button
        class="navbar-toggler"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
  </nav>
</header>
 
    <main role="main">
      
<article class="container">
  <header class="post-header py-3">
    <h1 class="post-title p-name" itemprop="name headline">Fractional Advance Widths vs. Advance Phantom Point</h1>
    <p class="text-muted">
              
      <time class="f6 mv4 dib tracked" datetime="2014-02-11T09:39:21Z">February 11, 2014</time>
      
        
          • <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">
            <a href="/?q=author:Bitblt">
            Bitblt
	    </a>
        </span></span>
      

    </p>
  </header>
  <div class="post-content e-content" itemprop="articleBody"><p>Hello Typophiles,</p>
<p>Apologies for the nerdiness on a first post.</p>
<p>In the midst of some last checks before releasing my first real font, I noticed an unpleasant beating frequency effect on repeated characters at smallish ppems when testing on Windows 7 with the &ldquo;Natural&rdquo; mode of DirectWrite ClearType rendering (tested via Firefox with the Anti-aliasing Tuner add-on).  The characters phase in and out of different degrees of bluriness.</p>
<p>With a bit of investigation, it looks like this is due to fractional advance widths.  I was hoping to be able to control for this by slightly adjusting the advance width phantom point via TrueType hinting.  However, it looks like Windows is ignoring that in this rendering mode and using only the designed width instead.</p>
<p>Attached is an extremely simple test case (TTX format, renamed to .txt) that shows this.  In the lower case x glyph slot it has a pointed cross occupying a 1000 font unit square, with a width set to 1000 font units (no sidebearings).  The glyph program is the following:</p>
<pre>SVTCA[x-axis]
PUSHB_2
 17            // Advance width phantom point (16 points in curve)
 0             // CVT 0 (2000 font units)
MIAP[no-rnd]</pre>
<p>The test font also has the following simple preprogram:</p>
<pre>PUSHB_2        // New font with ClearType support
 4
 3
INSTCTRL
PUSHW_1        // 64 pixel cut-in (i.e., not a factor)
 4096
SCVTCI</pre>
<p>Testing this out, I see that DirectWrite&rsquo;s GDI Classic and GDI Natural rendering modes correctly handle this; a string of xxxxx shows the expected double spacing between the glyphs.  However, this is missing from the Natural and Natural Symmetric modes and they render with something closer to the designed widths instead:</p>
<p><img src="/images/old-images/widthtest_4207.gif" alt=""></p>
<p>So this brings me to the following questions:</p>
<ol>
<li>
<p>Is there any voodoo that I can do to get it to honor hints that adjust the width?  Or am I simply stuck with the beat pattern here?</p>
</li>
<li>
<p>I notice that in the documentation for <code>DWRITE_RENDERING_MODE</code> for Windows 8 and later, the descriptions for Natural and Natural Symmetric mention that the glyph advances are rounded to whole pixels.  However, no such mention is made of this in the corresponding documentation for earlier versions of Windows.  Does Windows 8 therefore not have the same beat problem?</p>
</li>
</ol>
<p>Thanks!</p>
</div>

  
  <img src="/images/old-images/widthtest.txt" class="img-fluid">
  
   <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>Alas, the answer is that no, there isn&rsquo;t any voodoo you can do to get DWrite to respect the width hints.</p>
<p>Shortly after fractional width rendering (subpixel positioning) was introduced, I suggested to some people at MS that it would be good if there were a flag in the font that one could set to indicate to DWrite that one wanted full pixel spacing to be used. [The context for this is that we were designing some fonts for specific ppem sizes on full pixel grids, but when they were preceded on the line by other fonts they were getting knocked off the grid in DWrite environments.] The folks I spoke to agreed that such a flag would have been a useful thing, but thought it was too late to introduce it.</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2014-02-12 00:14:26"
			itemprop="datePublished"
		>
			2014-02-12 00:14:26
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:John&#43;Hudson">
            John Hudson
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2014-02-12 00:14:42"
			itemprop="datePublished"
		>
			2014-02-12 00:14:42
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:John&#43;Hudson">
            John Hudson
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>I&rsquo;m curious, why did you delete your first post?</p>
<p>hhp</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2014-02-12 03:13:33"
			itemprop="datePublished"
		>
			2014-02-12 03:13:33
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:hrant">
            hrant
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>Hi John,</p>
<p>Thanks for looking into that for me.  It&rsquo;s a shame to hear that, but I can&rsquo;t say I&rsquo;m suprised.</p>
<p>It&rsquo;s too bad that they seemed to go to such trouble to preserve backward compatibility with the various ClearType rendering options, but didn&rsquo;t provide a way for forward compatibility.  I&rsquo;d have thought that some combination of the GASP table and <code>INSTCTRL</code> (beyond just the 4 3 flag and selector) would be ideal.</p>
<p>I realize that the world is generally moving away from hinting, but from my experience as an enthusiastic amateur in font design, it still seems like carefully chosen TrueType instructions have every bit as much to say as the raw splines about the visual character of a font at lower resolutions.  Likewise, I feel feel strongly that the choice between whole pixel grids, subpixel grids, and lack of grids ought to be a design decision that belongs in the fonts themselves (at least for fonts new enough to be aware of such things).</p>
<p>Oh well.  Thanks again.</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2014-02-12 09:03:25"
			itemprop="datePublished"
		>
			2014-02-12 09:03:25
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:Bitblt">
            Bitblt
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><blockquote>I feel strongly that the choice between whole pixel grids, subpixel grids, and lack of grids ought to be a design decision that belongs in the fonts themselves</blockquote>
<p>I entirely agree.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2014-02-12 19:51:19"
			itemprop="datePublished"
		>
			2014-02-12 19:51:19
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:John&#43;Hudson">
            John Hudson
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Hrant, because it was administrative rather than informational.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2014-02-12 19:53:19"
			itemprop="datePublished"
		>
			2014-02-12 19:53:19
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:John&#43;Hudson">
            John Hudson
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>I think the deleted post did provide a certain kind of information: that you needed to consult somebody for the answer. I can&rsquo;t think of a good reason to have deleted it. Anyway, no huge deal.</p>
<p>hhp</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2014-02-12 20:59:55"
			itemprop="datePublished"
		>
			2014-02-12 20:59:55
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:hrant">
            hrant
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>&ldquo;&hellip;, it still seems like carefully chosen TrueType instructions have every bit as much to say as the raw splines about the visual character of a font at lower resolutions&rdquo;</p>
<p>This is a great observation, but it has been so long since the instructions were reliable. The proof is now out that only the rich can make viable solutions for the web, to a great extent, because of this windows rendering. And the bottleneck it has created is not just Google fonts opportunity.</p>
<p>&ldquo;Likewise, I feel feel strongly that the choice between whole pixel grids, subpixel grids, and lack of grids ought to be a design decision that belongs in the fonts themselves (at least for fonts new enough to be aware of such things).&rdquo;</p>
<p>This goes back to the gasp table&rsquo;s invention which is not so new either. What is new here is that so many more people understand the issue, and that the fonts MS was afraid of rendering because of evil hints, must be dead and gone by now?</p>
<p>My favorite comment, is that you&rsquo;d a thought MS would make Some Way forward for excellence in hinting. Can we have x back on windows now? Is the x box done hogging it?;)</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2014-02-14 01:01:03"
			itemprop="datePublished"
		>
			2014-02-14 01:01:03
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:dberlow">
            dberlow
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>hi Bitblt 
as John mentioned this is the situation right now. I am Mike Duggan by the way. Is it possible for you to introduce yourself?</p>
<p>cheers
mike</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2014-02-14 15:35:40"
			itemprop="datePublished"
		>
			2014-02-14 15:35:40
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:mike_duggan">
            mike_duggan
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2014-02-15 00:52:32"
			itemprop="datePublished"
		>
			2014-02-15 00:52:32
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:jasonc">
            jasonc
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>David: <em>&hellip;and that the fonts MS was afraid of rendering because of evil hints, must be dead and gone by now?</em></p>
<p>The fonts are not dead and gone, but the rendering environments at which their heavy delta hinting was targeted have died and gone, so the obvious solution would be to rehint those fonts for modern rendering environments.</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2014-02-15 19:32:33"
			itemprop="datePublished"
		>
			2014-02-15 19:32:33
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:John&#43;Hudson">
            John Hudson
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>Hi Mike,</p>
<p>Sure.  I&rsquo;m coming at things from the technical side.  I&rsquo;m a professional software developer with an expertise in graphics algorithms.</p>
<p>I spend a lot of time reading code on screen and several years ago I found myself not completely happy with any of the available typefaces.  So I set out to make one I&rsquo;d like to use.  Working on it soon became a hobby and I got a bit crazy with it (to the point of teaching myself to write TT hinting instructions).  What can I say? I&rsquo;m very demanding of my pixels, both at work and at home.</p>
<p>Cheers!</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2014-02-15 21:37:38"
			itemprop="datePublished"
		>
			2014-02-15 21:37:38
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:Bitblt">
            Bitblt
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>Damien? :-)</p>
<p>looking forward to seeing the font when its released. Please let us know when that happens.</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2014-02-16 11:42:41"
			itemprop="datePublished"
		>
			2014-02-16 11:42:41
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:mike_duggan">
            mike_duggan
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>JoHn:&ldquo;The fonts are not dead and gone, &quot;</p>
<p>I think they are. The instructions you are talking about, only make CT fonts blue, while the instructions I was talking about, were said to make whole computer screens blue.</p>
<p>&quot; so the obvious solution would be to rehint those fonts for modern rendering environments.&rdquo;</p>
<p>I think that&rsquo;s all done. As I should have said, the fonts that concerned MS in the transition from aliased to CT, are dead and rehinted.</p>
<p>Free Damien.;)</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2014-02-17 13:03:03"
			itemprop="datePublished"
		>
			2014-02-17 13:03:03
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:dberlow">
            dberlow
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Hello, again.  This perhaps deserves its own post under Release, but just to follow up on this thread I made the font in question, <a href="http://eastfarthing.com/luculent">Luculent</a>, available as of yesterday.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2014-03-08 20:04:03"
			itemprop="datePublished"
		>
			2014-03-08 20:04:03
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:Bitblt">
            Bitblt
	    </a>
			</span></span>
	</div>
	
</div>
 
</article>

    </main>
    
  </body>
</html>
