<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>dumps every glyph in a font to a text file | Typophile Archive</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="">
    <meta name="generator" content="Hugo 0.91.2" />
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

    <meta property="og:title" content="dumps every glyph in a font to a text file" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://typophile.github.io/node/85625/" /><meta property="article:section" content="node" />
<meta property="article:published_time" content="2011-09-20T02:11:47+00:00" />
<meta property="article:modified_time" content="2011-09-20T02:11:47+00:00" />

<meta itemprop="name" content="dumps every glyph in a font to a text file">
<meta itemprop="description" content=""><meta itemprop="datePublished" content="2011-09-20T02:11:47+00:00" />
<meta itemprop="dateModified" content="2011-09-20T02:11:47+00:00" />
<meta itemprop="wordCount" content="0">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="dumps every glyph in a font to a text file"/>
<meta name="twitter:description" content=""/>

  </head>

  <body class="ma0 avenir bg-near-white">

      <header>
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container">
      <a class="navbar-brand" href="/">Typophile Archive</a>
      <button
        class="navbar-toggler"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
  </nav>
</header>
 
    <main class="pb7" role="main">
      
<article class="container">
  <header class="post-header py-3">
    <h1 class="post-title p-name" itemprop="name headline">dumps every glyph in a font to a text file</h1>
    <p class="text-muted">
              
      <time class="f6 mv4 dib tracked" datetime="2011-09-20T02:11:47Z">September 20, 2011</time>
      
        
          • <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">flybrid</span></span>
      

    </p>
  </header>
  <div class="post-content e-content" itemprop="articleBody">some friends of mine recommend me to ask this kind of question here

I want to write a program which takes font name as the parameter and dumps every glyph in this font to a txt file

like    

bool dumpEveryGlyph(string fontName); 


I am wondering if there is any API which can help me to do this? (.net API?  win32 API?)

thanks very much </div>

   <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Here is a related thread: http://typophile.com/node/64147</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2011-09-20 03:02:56"
			itemprop="datePublished"
		>
			2011-09-20 03:02:56
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Michel Boyer</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">The tricky thing is that not every glyph in a font must have a code point assigned, that means these unencoded glyphs cannot be represented in a plain text file.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2011-09-20 13:07:09"
			itemprop="datePublished"
		>
			2011-09-20 13:07:09
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Jens Kutilek</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Jens is correct. You cannot dump <em>glyphs</em> into a text file because a glyph means exactly nothing. It's the code points that count, because these form the link between the ASCII (or Unicode) character code you want to display and the actual piece of graphic (the glyph) that's going to be drawn. It's extremely important to understand these concepts correctly before you are going to pull off some low-level trick as you are attempting.

(This bypasses any Opentype niceties, but then again it should. Opentype features have nothing to do with codepoints -- well, at least nothing you could 'dump into a txt file'.)

There are Windows APIs -- you don't tell, which is a mortal sin, but I presume you <em>are</em> talking about a Windows program here -- that can return font information, but I cannot remember if I really ever bothered to get down with those. My own experimental program is firmly based on my grasp of the file format of Truetype and Opentype font files, so I can locate and extract the all-important <code>cmap</code> entry and work it out from there.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2011-09-20 21:12:16"
			itemprop="datePublished"
		>
			2011-09-20 21:12:16
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Theunis de Jong</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">I see the request is from mainland China, where the preferred encoding is neither UTF-8 nor UTF-16 but <a href="http://en.wikipedia.org/wiki/Guobiao_code">GB 18030</a> and where the "niceties" of unicode may not be the main concern.

If you install ttx and apply <code>ttx -i -t cmap filename.extension</code> to your font file, giving the file <code>filename.ttx</code>, then the following Python code should give the desired text (on a single line) in <code>filename.txt</code>. Modifying the code to cut into lines, if needed, should be straightforward.

<PRE>
from xml.dom.minidom import *
import sys, re

f=open(sys.argv[1])
r1=re.compile(r'(.+)\.ttx$', re.IGNORECASE)
foutname=r1.match(sys.argv[1]).group(1)+".txt"
fout=open(foutname,'w')

doc=parse(f)

encdng='gb18030'

str=''
cmaps=doc.getElementsByTagName('cmap_format_12')
if not cmaps:
  cmaps=doc.getElementsByTagName('cmap_format_4')
maps=cmaps[0].getElementsByTagName('map')
for map in maps:
  code=int(map.getAttribute('code'),16)
  if code > 0x20:
    str=str+unichr(code)
fout.write("%s\n" % (str.encode(encdng)))
fout.close
</PRE>
Of course, 'gb18030' could be replaced by 'utf-8' or 'utf-16' or some other encoding. If you copy the lines above, save to some file, say <code>dmpcmap.py</code> and then execute
<PRE>
python dmpcmap.py filename.ttx
</PRE>
you get the text in <code>filename.txt</code>

This was tested on a Mac with <code>python26 @2.6.7_1+ucs4</code> on the font ST Heiti

Michel

PS The code does not check the platform because on my Mac, there are fonts without a cmap for Windows and I wanted to get an output file. Also, the code is slow on large files.
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2011-09-22 01:13:23"
			itemprop="datePublished"
		>
			2011-09-22 01:13:23
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Michel Boyer</span
			></span
		>
	</div>
	
</div>
 
</article>

    </main>
    
  </body>
</html>
