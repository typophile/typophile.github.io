<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Question about OT Scripting and file size | Typophile Archive</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="">
    <meta name="generator" content="Hugo 0.91.2" />
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

    <meta property="og:title" content="Question about OT Scripting and file size" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://typophile.github.io/node/46034/" /><meta property="article:section" content="node" />
<meta property="article:published_time" content="2008-06-03T22:15:58+00:00" />
<meta property="article:modified_time" content="2008-06-03T22:15:58+00:00" />

<meta itemprop="name" content="Question about OT Scripting and file size">
<meta itemprop="description" content=""><meta itemprop="datePublished" content="2008-06-03T22:15:58+00:00" />
<meta itemprop="dateModified" content="2008-06-03T22:15:58+00:00" />
<meta itemprop="wordCount" content="0">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Question about OT Scripting and file size"/>
<meta name="twitter:description" content=""/>

  </head>

  <body class="ma0 avenir bg-near-white">

      <header>
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container">
      <a class="navbar-brand" href="/">Typophile Archive</a>
      <button
        class="navbar-toggler"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
  </nav>
</header>
 
    <main class="pb7" role="main">
      
<article class="container">
  <header class="post-header py-3">
    <h1 class="post-title p-name" itemprop="name headline">Question about OT Scripting and file size</h1>
    <p class="text-muted">
              
      <time class="f6 mv4 dib tracked" datetime="2008-06-03T22:15:58Z">June 3, 2008</time>
      
        
          • <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">ebensorkin</span></span>
      

    </p>
  </header>
  <div class="post-content e-content" itemprop="articleBody">I was thinking about the practical issues involved in using Calt/Liga for text faces today, and I started wondering about how much larger a file might be if it has has 10, 50, 100, 1000 or 10,000 feature entries. And what the real practical limitations might be in terms of the file size, for the Operating System (OSX, Windows Vista, XP etc.) , and applications, any one of which might potentially choke on an overly big file. Maybe file size per se isn't the only technical issue. I am BTW deliberately leaving out any mention of managing large #s of features which is essentially a different issue.

It's a broad question, and I know the answers are probably very specific and potentially very case dependent.

Still, what is your take on this? Have you run into problems regarding this kind of thing as an OS, application, or font developer you would like to share?</div>

   <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">There's a 64K limit on the size of a subtable offset (I think I have that right). This can be worked around with the "extension" function and appropriate subtable breaks, although not all possible clients will recognize that. Usually this comes up with kerning for really big fonts (e.g. Arno Pro).

There are a couple of size limits related to glyphs rather than features, as well:

1) Mac OS used to have a limit on the total length of glyph name strings, as well. That has been fixed at some point.

2) There's the limit of 64K glyphs in the font.

Regards,

T</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-06-04 01:09:15"
			itemprop="datePublished"
		>
			2008-06-04 01:09:15
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Thomas Phinney</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">I'm playing with interleaved contextual and stylistic set stuff for display type that goes way beyond anything that I would anticipate in a text face, and I have not hit any size limits in terms of software support -- at least not in my test environments, which in this case are InDesign and WPF --, although I have hit (anticipated) feature implementation issues. Sergey Malkin at MS confirms that my VOLT source for this project is the largest and most complex he has seen (a record I previously held with SBL Hebrew), and the GSUB table takes up something like 40% of the compiled font. This is the stuff I'll be showing at TypeCon this year.

I can't imagine anything on that magnitude being necessary in a text face, even presuming that some characters have multiple forms for improved fit. Also, from my perspective there is an important net gain in not using ligature glyphs any more, since it massively simplifies the GPOS mark positioning work.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-06-04 01:32:35"
			itemprop="datePublished"
		>
			2008-06-04 01:32:35
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>John Hudson</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">PS. All my OTL work is done in VOLT, so I don't know what kind of tool issues you might hit with FontLab/FDK.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-06-04 01:33:31"
			itemprop="datePublished"
		>
			2008-06-04 01:33:31
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>John Hudson</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">PPS. Surely this is a 'Build' question?</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-06-04 01:35:54"
			itemprop="datePublished"
		>
			2008-06-04 01:35:54
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>John Hudson</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><cite>Surely this is a ’Build’ question?</cite>

Quite so. Thanks for moving it, whoever that was!

I had sort of assumed that what you have said here was so, but then I realized that it was quite an assumption to be leaning on if it was false. So, thanks John!</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-06-04 03:34:21"
			itemprop="datePublished"
		>
			2008-06-04 03:34:21
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>ebensorkin</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">I must confess that large size of GSUB table in presence of complex lookups is the result of VOLT compiler not doing enough optimization work. As I understand, AFDK is doing better job. But contextual lookups usually do not have functional problems (resulting table may be too big for my taste, but will still work), positioning is much more problematic.

But this does not make John's work less complex and less amazing. Besides quality, his fonts are always my best VOLT testbed :).

Sergey</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-06-04 08:23:37"
			itemprop="datePublished"
		>
			2008-06-04 08:23:37
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>sergeym</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Thomas -- <cite>1) Mac OS used to have a limit on the total length of glyph name strings, as well. That has been fixed at some point.</cite>

Do you know in <em>which</em> version this was fixed? I wonder if we need to pay tribute to this issue in future ...
My impression is that someone who wants to use an ultra-plus font simply needs to accept some minimal system requirements -- like with any other piece of software too. (And me being the last OSX 10.3 user anyway.)&nbsp;&nbsp;:)

Karsten</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-06-04 10:09:57"
			itemprop="datePublished"
		>
			2008-06-04 10:09:57
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>k.l.</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Karsten, I'm still running OSX 10.3.9 also. ;-)</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-06-04 14:02:43"
			itemprop="datePublished"
		>
			2008-06-04 14:02:43
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>kentlew</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Must have to do with our initials.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-06-04 15:51:44"
			itemprop="datePublished"
		>
			2008-06-04 15:51:44
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>k.l.</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">> <em>Do you know in which version this was fixed?</em>

It was fixed in OS X 10.4.9, http://support.apple.com/kb/HT1525 This problem only affects name-keyed OT-CFF fonts. Here are some screenshots I took at that time. Don't try this at home! The likelihood of getting a [[http://en.wikipedia.org/wiki/Kernel_panic|kernel panic]] is quite high.
[img:sites/default/files/old-images/Arno_Fontbook_1_5345.png]
[img:sites/default/files/old-images/Arno_Fontbook_2_6100.png]
[img:sites/default/files/old-images/Arno_Fontbook_3_6139.png]</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-06-04 20:59:57"
			itemprop="datePublished"
		>
			2008-06-04 20:59:57
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Miguel Sousa</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Speaking of optimization, Read Roberts explained to me that there's not much a font developer can do to reduce the font file size. If the designer really thinks that the typeface is better served by having 30 OpenType features implemented in the font, or 20 contextual lookups, then there's no way you can compress that data to become half its size. Surely, sometimes lookups can be shared between features (e.g. you can define a lookup to be used by 'subs', and then reference that same lookup in 'sinf'), but for the most part each feature has its own unique lookup.

Having said that, from a text engine point of view, contextual lookups will definitely make a bigger dent on the processing performance than one-to-one lookups do, obviously. So, if you need to use contextual lookups try to keep their number low and each context as short as possible. (Contextual lookups are like [[http://en.wikipedia.org/wiki/Regular_expressions|regular expressions]], the more complex they are, the longer they take to process. No way to avoid that.)

Of course there are some good practices a font developer should observe, which will help keep the font file size low. A simple one is to arrange the glyphs in the font into groups. So for example, putting the a–z glyphs into a continuos range, and then ordering their corresponding small cap glyphs (a.sc–z.sc) in the same way, will keep the size of the lookup generated by this substitution rule,

<code>sub [a b c ... y z] by [a.sc b.sc c.sc ... y.sc z.sc];</code>

at its minimum. This is because the GID ranges will be continuos and the offset from the original glyph to the resulting glyph is constant. I should stress that the secret to make this work relies on the way the glyphs are ordered throughout the font, not the way the features are written. This means that, if the glyphs are neatly ordered in the font, it doesn't matter if you use the code above, or any of the substitutions below.

<code>sub [z y ... c b a] by [z.sc y.sc ... c.sc b.sc a.sc];
sub [c y a ... z b] by [c.sc y.sc a.sc ... z.sc b.sc];</code>

Actually, recently I did an experiment in this area with one of our biggest Western fonts, Arno Pro. I took the original GlyphOrderAndAliasDB file, randomized the order of its lines (with the exception of the first line which must correspond to the .notdef glyph), and rebuilt one of the Italic fonts. Keep in mind I didn't change anything else; the OT code used, the PFA source font and all the supporting files were exactly the same. The results were interesting: 9% increase of the file size (460Kb to 504Kb). I guess the takeaway is, it pays-off to spend some time rationalizing the glyph order.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-06-04 22:45:58"
			itemprop="datePublished"
		>
			2008-06-04 22:45:58
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Miguel Sousa</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">There is a lag time in opening up a file, or changing a font, when a font with a lot of contextual lookups is involved.

A user might think this is an issue with the font, but probably not, as the wait time is quite short compared to, say, opening a gigabyte Photoshop file with dozens of layers.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-06-04 23:52:05"
			itemprop="datePublished"
		>
			2008-06-04 23:52:05
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Nick Shinn</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">When I was a kid, we had to walk 5 miles through the snow to get to school, uphill both ways . . .

But actually, I did start withe a PC-XT -- which used the 8088 chip. We typeset using TeX. The way you did it was to kick off your files when you went home at night; it took about 6 hours to run a typical book. Last time I used TeX, the same chore would take around a minute.

I'm not a machine oriented guy, but the moral is it may seem a bit slow today; it won't be tomorrow.

Now all I gotta figure out is how Nick got one of my Photoshop files (and Nick, add that you're using the 16-bit mode for the intermediate, working file . . .)</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-06-05 01:42:17"
			itemprop="datePublished"
		>
			2008-06-05 01:42:17
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>charles ellertson</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Hello Miguel, very belated thanks for the information! Karsten</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-06-06 15:16:58"
			itemprop="datePublished"
		>
			2008-06-06 15:16:58
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>k.l.</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Me too. This was a very useful thread!</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-06-06 19:28:55"
			itemprop="datePublished"
		>
			2008-06-06 19:28:55
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>ebensorkin</span
			></span
		>
	</div>
	
</div>
 
</article>

    </main>
    
  </body>
</html>
