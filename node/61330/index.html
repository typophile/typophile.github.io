<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Accents, AFDKO, and InDesign | Typophile Archive</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="">
    <meta name="generator" content="Hugo 0.91.2" />
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

    <meta property="og:title" content="Accents, AFDKO, and InDesign" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://typophile.github.io/node/61330/" /><meta property="article:section" content="node" />
<meta property="article:published_time" content="2009-08-24T21:26:54+00:00" />
<meta property="article:modified_time" content="2009-08-24T21:26:54+00:00" />

<meta itemprop="name" content="Accents, AFDKO, and InDesign">
<meta itemprop="description" content=""><meta itemprop="datePublished" content="2009-08-24T21:26:54+00:00" />
<meta itemprop="dateModified" content="2009-08-24T21:26:54+00:00" />
<meta itemprop="wordCount" content="0">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Accents, AFDKO, and InDesign"/>
<meta name="twitter:description" content=""/>

  </head>

  <body class="ma0 avenir bg-near-white">

      <header>
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container">
      <a class="navbar-brand" href="/">Typophile Archive</a>
      <button
        class="navbar-toggler"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
  </nav>
</header>
 
    <main class="pb7" role="main">
      
<article class="container">
  <header class="post-header py-3">
    <h1 class="post-title p-name" itemprop="name headline">Accents, AFDKO, and InDesign</h1>
    <p class="text-muted">
              
      <time class="f6 mv4 dib tracked" datetime="2009-08-24T21:26:54Z">August 24, 2009</time>
      
        
          • <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Theunis de Jong</span></span>
      

    </p>
  </header>
  <div class="post-content e-content" itemprop="articleBody">To my utter delight, the new [[http://www.adobe.com/devnet/opentype/afdko/|AFDKO]] now supports proper mark-to-base and mark-to-mark features -- not limited to TrueType 'attachment points', it works perfectly with CFF (Type 1s) as well. So I spend the weekend updating my accents font, removing all rligs that glued a myriad of specifically spaced accents to a few characters and replacing them with a single accent glyph. I even could use the free DTL OTMaster Light to proof them! (And I am utterly convinced the full version is worth its full price, because with that I could have done the positioning straight away!)

Here's the catch.

Traditionally, I positioned my accent glyphs <em>after</em> its base glyph, then manually kerned it into place. The positioned accents I created had, therefore, to be of zero width and <em>on the left side</em> of the zero line. After some initial problems, I worked out I still could position its anchor points on the base point per accent:

<code>  markClass [ @ALLTOPMARKS ] &lt;anchor -250 500&gt; @TOP_MARKS;</code>

-- the entire accent glyph is centered horizontally inside a 500 unit wide rectangle. So all I had to do was for umpteen characters figure out where <em>their</em> (optical) center was, and set the position for their anchor:

<code>  position base [ g ] &lt;anchor 240 500&gt; mark @TOP_MARKS
		  &lt;anchor 240 -250&gt; mark @BOTTOM_MARKS;</code>

Works like a charm in OTMaster. I could even work out vertical stacking of the accents (mark-to-mark). Now the strange thing is, when testing with InDesign CS4, vertical stacking works as advertised, but the <strong>horizontal position</strong> is off by an entire character width. If I type in

m &lt;acute&gt;

the acute appears the exact width of the 'm' to the right. I have confirmed this by typing in another 'm' right after the acute, and <em>then</em> the accent was placed perfectly -- on the next 'm'.

What are the conventions for combining accents? Should they have a non-zero width after all? (I think their widths would be discarded because they're positioned with the mark-to-base feature.) Should they be zero-width and on the <em>right hand side</em> of the null line? (That would imply that, lacking mark-to-base, one would type first the accent and then the base glyph -- which is, I admit, <em>also</em> a historical convention -- typewriter style.)

Or is OTMaster behaving correctly, and IDCS4 not?</div>

   <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Combining mark glyphs should be zero-width. [The exception is in monospaced fonts, in which the combining marks must have the same advance width as all the other glyphs. In this case, the width is collapsed in the GPOS lookups as part of the mark positioning.]

It doesn't matter where on the zero-width the actual outline is positioned. Typically, the default position is set to offset the mark over the preceding letter in cases where GPOS mark attachments are not supported. So for left-to-right scripts the outline is offset to the left of the zero-width, and for right-to-left scripts it is offset to the right. [The exception is Hebrew, in which the marks are typically centered optically on the zero-width, which allows them to be used by legacy Hebrew engines that employed algorithmic horizontal positioning.]</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2009-08-25 23:07:44"
			itemprop="datePublished"
		>
			2009-08-25 23:07:44
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>John Hudson</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">The most recent Adobe fonts follow the same approach John described for Hebrew fonts above, i.e. centering glyphs optically on the zero width.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2009-08-25 23:26:54"
			itemprop="datePublished"
		>
			2009-08-25 23:26:54
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>paul d hunt</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Okay, thanks so far.

<cite>It doesn’t matter where on the zero-width the actual outline is positioned.</cite>

That's what I assumed. It seems I'm making some mistake elsewhere -- just for laughs I moved the accents to the <em>right</em> side of the zero line, and the results are exactly the same in OTMaster (correct) and CS4 (wrong).

[img:sites/default/files/old-images/more-accents_5051.PNG]

The acute is right after the 'm' and should be on top -- adding an extra 'm' after that shows the position is correct, apart from the minor issue it's too far to the right.

The mk2base is now in 'rlig', I'll put them somewhere else and see what changes.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2009-08-26 10:05:26"
			itemprop="datePublished"
		>
			2009-08-26 10:05:26
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Theunis de Jong</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Is my face red and all. I said

<cite>The mk2base is now in ’rlig’ ...</cite>

and remembered Microsoft has a list of which feature should go where. That got me thinking. <code>mark</code> and <code>mkmk</code> <em>are</em> the feature names (and the only stuff that goes into these are the commands that perform the actual attachment) -- they shouldn't occur in <code>rlig</code> or anywhere else.

(This solves the shifting-to-the-right -- have to think a bit more about <code>mkmk</code>.)</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2009-08-27 09:39:37"
			itemprop="datePublished"
		>
			2009-08-27 09:39:37
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Theunis de Jong</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Well, call me officially stumped.

This is with all accents centered in a 500 unit wide box, with zero width:

[img:sites/default/files/old-images/more_ie_fun_6403.PNG]

in lowly Windows' WordPad. (See also note below.) This is the same font in DTP powerhouse CS4:

[img:sites/default/files/old-images/ie_fun_cs4_6738.PNG]

As you can see, the top (mkmk) accents go wildly out of whack. It doesn't matter whether I add a bottom accent or not -- the result is the same.

I don't trust my OTF font making abilities enough, so I did the same using Legendum, with this result (CS4):

[img:sites/default/files/old-images/ie_no_fun_3801.PNG]

and SIL Doulos -- top WordPad, bottom CS4:

[img:sites/default/files/old-images/hummbug_5249.PNG]

-- so it seems <code>mkmk</code> doesn't <em>really</em> work in CS4, while I'm pretty sure it was mentioned as a new feature (perhaps even here on Typophile).
I'd be gladly proven wrong. Anyone?

--
[Note] For some reason my custom glyph names-per-unicode do not survive the export to PFB/makeOTF trajectory, they never make it into the PFB. Custom names are preferred, because it makes writing the feature file just that bit easier (using "macroncomb" and "opene" rather than "uni030F" and "uni2011"). A rather unfortunate side effect is that these glyphs don't appear in Wordpad.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2009-08-28 16:14:04"
			itemprop="datePublished"
		>
			2009-08-28 16:14:04
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Theunis de Jong</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Theunis, this is a known bug in CS4 http://typophile.com/node/52173</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2009-08-28 21:41:17"
			itemprop="datePublished"
		>
			2009-08-28 21:41:17
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Miguel Sousa</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Miguel, thanks for affirming it hasn't bin fixed as of this date.

As you can see by those older posts (and the even older one referred therein), it's quite the issue for me -- that's why I keep trying. At the very least, Wordpad -- of all possible programs! -- showed me there is nothing wrong with my understanding of the AFDKO (and I'm really thankful to Adobe for their free dev kit! It <em>does</em> tie in nicely to my scripting abilities.)

Note To Self: Try again in another 6 months :-(</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2009-08-28 22:25:33"
			itemprop="datePublished"
		>
			2009-08-28 22:25:33
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Theunis de Jong</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><em>At the very least, Wordpad — of all possible programs! — showed me there is nothing wrong...</em>

If you want a really pure test of whether something might be wrong with the font, NotePad is even better than Wordpad: just the font and the layout engine, and nothing else to get in the way.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2009-08-29 00:05:46"
			itemprop="datePublished"
		>
			2009-08-29 00:05:46
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>John Hudson</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">No feature bloat, eh? Thanks, I'll keep it in mind for the next time 'round.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2009-08-29 00:53:14"
			itemprop="datePublished"
		>
			2009-08-29 00:53:14
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Theunis de Jong</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Today I did some tests with Notepad, WordPad and Word 2007 using Doulos SIL, and the above combining accents don't stack more than 3 times. Is this a reasonable limit? Should there be any limit at all?

I understand this limit is not being imposed by the font; FWIW, I've opened the same RichText file in OS X's TextEdit and the 7 above combining accents I used were all visible and stacked vertically.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2009-09-24 21:28:57"
			itemprop="datePublished"
		>
			2009-09-24 21:28:57
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Miguel Sousa</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Miguel, 

a limit of 3 seems like a strange way of implementing it in the font. 

The Windows Vista/Windows 7 versions of Arial and Times New Roman can stack accents pretty infinitely in Notepad or Word 2007, last I checked. 

Cheers,
Adam</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2009-09-25 02:17:11"
			itemprop="datePublished"
		>
			2009-09-25 02:17:11
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>twardoch</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">I didn't say the limit was in the font. I don't think it is.

I'm also using Windows Vista and Word 2007 (v12.0.6425.1000). Just tried Arial and TNR, and I only see 2 or 3* accents. The other accents might be there, but I can't see or print them.

*  sometimes 2.5 depending on the size of the text and the accents used</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2009-09-25 20:37:02"
			itemprop="datePublished"
		>
			2009-09-25 20:37:02
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Miguel Sousa</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Guys -- thanks for delving a bit deeper into this.

I don't think there is an <em>implementation</em> defined limit to the number of stacked accents; I can't remember reading anything about that. Besides, there seems to be no way of knowing which 'number' one particular accent has in its stacking order. <code>mkmk</code> accents only have positions relative to the preceding one, and the very first relative to its parent glyph.

That said, I'm also not sure why there would be a hard-coded limitation in an OTF drawing routine, it could be written as a simple repeating piece of code (at least, that's how I would've done it ;-).

I suspect it's more a bug (or 'feature') in the way type gets blitted; it may be to a buffer restricted to the current font height plus ascenders, something like that. Do Word, Notepad, and Wordpad all use the same drawing APIs? (And -- again, just suspecting -- the answer is likely to be 'yes'.)</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2009-09-25 22:25:29"
			itemprop="datePublished"
		>
			2009-09-25 22:25:29
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Theunis de Jong</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">[In brackets, not directly related to the issue you describe. There may be no limit to the number of marks stacked. Yet if you intend to kern base glyph combinations depending on marks sitting above or below them to avoid clashes, in which case mark glyphs serve as context, you are forced to "limit" the number of mark glyphs taken into consideration for the simple reason that context is always a specific context. Add one more mark to the string and your kerning will stop working.]</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2009-09-25 23:05:32"
			itemprop="datePublished"
		>
			2009-09-25 23:05:32
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>k.l.</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Back to the IDCS4 issue, <a href="http://www.thomasphinney.com/2009/01/adobe-world-ready-composer/" target="_blank">perhaps this might help</a>.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2009-09-25 23:08:51"
			itemprop="datePublished"
		>
			2009-09-25 23:08:51
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>k.l.</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Miguel, I believe the limit you report is a clipping zone issue. In Word, try setting the linespacing in the paragraph dialogue to an exact leading value, rather than a multiple of the default linespacing; this should reveal all the stacked accents

[img:sites/default/files/old-images/cambriaaacuteacuteacute_5040.gif]

Also, printing to PDF should reveal them even if they are hidden in Word.

[The illustration shows the Win7 version of Cambria, in Word on exact leading, with mark-to-base and mark-to-mark attachment implemented.]</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2009-09-27 19:55:16"
			itemprop="datePublished"
		>
			2009-09-27 19:55:16
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>John Hudson</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Hey, a new way of typing "aaaaaahhhh..."!

Thanks, John -- that makes perfect sense. I seem to have guessed right :-)

<cite>.. printing to PDF should reveal them ..</cite>

Wordpad didn't show my accents either until I printed to PDF -- although Miguel <em>did</em> say

<cite>.. I can’t see or print them </cite>

Still, nothing to worry about for font developers, as it must be a software thing: Trying to catch up with the standard :-D</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2009-09-27 22:44:45"
			itemprop="datePublished"
		>
			2009-09-27 22:44:45
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Theunis de Jong</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Thanks for the tips. I shall try again.

On a related note, is there a real-world example of an orthography that stacks more than two accents in each direction?</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2009-09-27 23:26:12"
			itemprop="datePublished"
		>
			2009-09-27 23:26:12
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Miguel Sousa</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">If there is it must be something along the lines of Guillaume Apollinaires work, Merz or DADA (collage).

. . .
Bert Vanderveen BNO</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2009-09-28 13:49:07"
			itemprop="datePublished"
		>
			2009-09-28 13:49:07
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Bert Vanderveen</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">My examples above are based on that old chestnut ie_fun.jpg (David Bürgin's thread [[http://www.typophile.com/node/13042|Anchors in Fontlab?]]):

[img:sites/default/files/old-images/ie_fun_6695.jpg]

which is Indo-European reconstructed stuff (recognizable by its initial asterisk). This stacks tons of stuff on top, but I can't find (nor remember) if same happens belowdecks.

(On 2nd sight, yes, definitely Dadaistic influences! :-)</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2009-09-28 14:47:51"
			itemprop="datePublished"
		>
			2009-09-28 14:47:51
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Theunis de Jong</span
			></span
		>
	</div>
	
</div>
 
</article>

    </main>
    
  </body>
</html>
