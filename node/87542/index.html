<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>useExtension and AFDKO 2.5 | Typophile Archive</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="">
    <meta name="generator" content="Hugo 0.91.2" />
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

    <meta property="og:title" content="useExtension and AFDKO 2.5" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://typophile.github.io/node/87542/" /><meta property="article:section" content="node" />
<meta property="article:published_time" content="2011-11-18T20:05:54+00:00" />
<meta property="article:modified_time" content="2011-11-18T20:05:54+00:00" />

<meta itemprop="name" content="useExtension and AFDKO 2.5">
<meta itemprop="description" content=""><meta itemprop="datePublished" content="2011-11-18T20:05:54+00:00" />
<meta itemprop="dateModified" content="2011-11-18T20:05:54+00:00" />
<meta itemprop="wordCount" content="0">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="useExtension and AFDKO 2.5"/>
<meta name="twitter:description" content=""/>

  </head>

  <body class="ma0 avenir bg-near-white">

      <header>
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container">
      <a class="navbar-brand" href="/">Typophile Archive</a>
      <button
        class="navbar-toggler"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
  </nav>
</header>
 
    <main class="pb7" role="main">
      
<article class="container">
  <header class="post-header py-3">
    <h1 class="post-title p-name" itemprop="name headline">useExtension and AFDKO 2.5</h1>
    <p class="text-muted">
              
      <time class="f6 mv4 dib tracked" datetime="2011-11-18T20:05:54Z">November 18, 2011</time>
      
        
          • <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">agisaak</span></span>
      

    </p>
  </header>
  <div class="post-content e-content" itemprop="articleBody"><p>I&rsquo;ve run into a problem with GSUB coverage offset overflow errors in a largish font I have been working on. Adding useExtension to various lookups solves the problem when generating the font in FLS 5.0.4, but not in 5.1 where the error remains. Moreover, attempting to compile directly using AFDKO also fails, so I suspect that there is a bug in AFDKO 2.5 which is somehow causing the useExtension directive to be ignored.</p>
<p>I was wondering if anyone has successfully compiled code using this directive either in AFDKO 2.5 (or FLS 5.1 which relies on AFDKO 2.5). This would help me determine whether this is indeed the root of the problem or whether there is some other less obvious problem with my code which FLS 5.0.4 (ADFKO 1.6) accepts but which FLS 5.1 (AFDKO 2.5) does not.</p>
<p>(n.b. by &lsquo;successfully compiled&rsquo; I mean compiled where the directive is actually necessary to prevent overflows &ndash; not just where it is present).</p>
<p>André</p>
</div>

   <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>Hi André;</p>
<p>Older versions of the FDK are not posted for download. I could recover an installable version of 1.6, but I think it would be a lot less work to make your features file work with 2.5. I can guarantee that the useExtension directive does work under 2.5, and that if the font can be <em>correctly</em> built with 1.6, it can also be built with FDK 2.5. Please send me the error log from the makeotf run, and I&rsquo;ll see what I can figure out (<a href="mailto:rroberts@adobe.com">rroberts@adobe.com</a>).</p>
<ul>
<li>Read Roberts</li>
</ul>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2011-11-18 22:44:52"
			itemprop="datePublished"
		>
			2011-11-18 22:44:52
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Read Roberts</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>After some additional hair-pulling I&rsquo;ve discovered (fingers crossed) the source of my problem, though I&rsquo;m still a bit mystified as to why FLS 5.0.4 and FLS 5.1 are behaving differently.</p>
<p>In my original font (begun pre FLS 5.1), I&rsquo;d tried to get around the lack of standalone lookups in FDK 1.6 by defining all of my lookups in a single, unregistered dummy feature at the beginning of my feature list, and then simply using lookup references in all my actual feature definitions.</p>
<p>I&rsquo;ve discovered that if I split this dummy feature into two (or more) dummy features, suddenly I can solve my offset overflow problems with useExtension. Apparently, FLS 5.1 chokes if the combined size of lookups <em>within a single feature block</em> exceeds a the size of a 16-bit offset.</p>
<p>I don&rsquo;t understand <em>why</em> it cares whether the lookups are declared within a single feature block or not, but apparently it does.</p>
<p>André</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2011-11-19 18:34:29"
			itemprop="datePublished"
		>
			2011-11-19 18:34:29
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>agisaak</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">(If I got you right, you&rsquo;re using FLS 5.1 now. Rather than using two dummy features instead of one, did you try to remove the <!-- raw HTML omitted -->feature **** {<!-- raw HTML omitted --> and <!-- raw HTML omitted -->} ****;<!-- raw HTML omitted --> wrapper around your lookup definitions entirely?)</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2011-11-19 22:39:08"
			itemprop="datePublished"
		>
			2011-11-19 22:39:08
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>k.l.</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>It turns out that my original assessment was incorrect (Karsten&rsquo;s comment clued me into this since I&rsquo;d already tried that to no avail, and if that didn&rsquo;t work, there&rsquo;s no reason to think breaking the feature up should matter).</p>
<p>It turns out I&rsquo;d made a rather foolish mistake &ndash; I&rsquo;d performed this experiment on the <em>wrong</em> version of the font, and was dealing with a shorter set of code. Here, breaking up the container feature made a difference, but the reason for this turns out to be less than mysterious.</p>
<p>I&rsquo;d started out with a single container feature, <!-- raw HTML omitted -->AGIT<!-- raw HTML omitted -->, which I&rsquo;d broken into <!-- raw HTML omitted -->AGIT<!-- raw HTML omitted --> and <!-- raw HTML omitted -->AGI2<!-- raw HTML omitted -->, which contained roughly the same amount of code. I&rsquo;d forgotten, though, that the feature file began with:</p>
<p><!-- raw HTML omitted -->feature aalt {<!-- raw HTML omitted -->
<!-- raw HTML omitted -->    feature AGIT;<!-- raw HTML omitted -->
<!-- raw HTML omitted -->} aalt;<!-- raw HTML omitted --></p>
<p>Since <!-- raw HTML omitted -->AGIT<!-- raw HTML omitted --> was now roughly half as long, it&rsquo;s no wonder the GSUB table shrank.</p>
<p>When I return to the .vfb I&rsquo;d intended to work with, I get the same problem &ndash; a single <!-- raw HTML omitted -->useExtension<!-- raw HTML omitted --> is needed in FLS 5.0.4/FDK 1.6 but no amount of <!-- raw HTML omitted -->useExtension<!-- raw HTML omitted -->s will prevent overflows in FLS 5.1/FDK 2.5</p>
<p>However, this seems to be restricted to this one file. I&rsquo;d thought it extended to some other files as well, but it turns out the problem was solvable in these. It seems that FDK 2.5 produces longer GSUB code than FDK 1.6 by around 25%. So, except for my single problematic .vfb, <!-- raw HTML omitted -->useExtension<!-- raw HTML omitted --> will correct overflows, but it needs to be added to more lookups. After finding the problem wouldn&rsquo;t go away in my one file, I gave up too easily on the others rather than continuing to add <!-- raw HTML omitted -->useExtension<!-- raw HTML omitted --> until I was able to compile.</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2011-11-23 13:14:28"
			itemprop="datePublished"
		>
			2011-11-23 13:14:28
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>agisaak</span
			></span
		>
	</div>
	
</div>
 
</article>

    </main>
    
  </body>
</html>
