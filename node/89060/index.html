<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>On Lion and can’t get TTX to work anymore. | Typophile Archive</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="">
    <meta name="generator" content="Hugo 0.91.2" />
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

    <meta property="og:title" content="On Lion and can’t get TTX to work anymore." />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://typophile.github.io/node/89060/" /><meta property="article:section" content="node" />
<meta property="article:published_time" content="2012-01-13T17:13:41+00:00" />
<meta property="article:modified_time" content="2012-01-13T17:13:41+00:00" />

<meta itemprop="name" content="On Lion and can’t get TTX to work anymore.">
<meta itemprop="description" content=""><meta itemprop="datePublished" content="2012-01-13T17:13:41+00:00" />
<meta itemprop="dateModified" content="2012-01-13T17:13:41+00:00" />
<meta itemprop="wordCount" content="0">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="On Lion and can’t get TTX to work anymore."/>
<meta name="twitter:description" content=""/>

  </head>

  <body class="ma0 avenir bg-near-white">

      <header>
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container">
      <a class="navbar-brand" href="/">Typophile Archive</a>
      <button
        class="navbar-toggler"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
  </nav>
</header>
 
    <main class="pb7" role="main">
      
<article class="container">
  <header class="post-header py-3">
    <h1 class="post-title p-name" itemprop="name headline">On Lion and can’t get TTX to work anymore.</h1>
    <p class="text-muted">
              
      <time class="f6 mv4 dib tracked" datetime="2012-01-13T17:13:41Z">January 13, 2012</time>
      
        
          • <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Goran Soderstrom</span></span>
      

    </p>
  </header>
  <div class="post-content e-content" itemprop="articleBody">I just switch to a brand new computer and set up everything but can’t get TTX to work.

I see this when i type ttx in the terminal so I think it’s installed right?

---------------

 TTX 2.3 -- From OpenType To XML And Back

    If an input file is a TrueType or OpenType font file, it will be
       dumped to an TTX file (an XML-based text format).
    If an input file is a TTX file, it will be compiled to a TrueType
       or OpenType font file.

etc .... 

---------------

But when actually trying to work on a font file I get this:

---------------

  File "/usr/local/bin/ttx", line 11, in <module>
    ttx.main(sys.argv[1:])
  File "/Library/Python/2.7/site-packages/FontTools/fontTools/ttx.py", line 295, in main
    process(jobs, options)
  File "/Library/Python/2.7/site-packages/FontTools/fontTools/ttx.py", line 280, in process
    action(input, output, options)
  File "/Library/Python/2.7/site-packages/FontTools/fontTools/ttx.py", line 170, in ttDump
    fontNumber=options.fontNumber)
  File "/Library/Python/2.7/site-packages/FontTools/fontTools/ttLib/__init__.py", line 145, in __init__
    if macUtils.getSFNTResIndices(file):
  File "/Library/Python/2.7/site-packages/FontTools/fontTools/ttLib/macUtils.py", line 28, in getSFNTResIndices
    resref = MyOpenResFile(path)
  File "/Library/Python/2.7/site-packages/FontTools/fontTools/ttLib/macUtils.py", line 18, in MyOpenResFile
    resref = Res.FSpOpenResFile(path, mode)
AttributeError: 'module' object has no attribute 'FSpOpenResFile'

---------------

On Lion with Python 2.7.

Any ideas what could be wrong? Would really appreciate it.</div>

   <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">I have not installed ttx2.3 on Lion. I am using ttx2.2 from AFDKO with no problem. Here are the differences between 2.2 and 2.3 according to the file changes.txt
<code>
TTX/FontTools Version 2.3</code>
<code>
- TrueType Collection (TTC) support
- Python 2.6 support
- Update Unicode data to 5.2.0
- Couple of bug fixes
</code>
Maybe I should add that the AFDKO ttx comes with its own python, it does not rely on some pre-installed python.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2012-01-13 17:40:36"
			itemprop="datePublished"
		>
			2012-01-13 17:40:36
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Michel Boyer</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">This is the TTX that comes with Fonttools in the Robofab package.

So. it doesn't support Python 2.7 which came with the computer? Is that what you're meaning?


</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2012-01-13 17:46:52"
			itemprop="datePublished"
		>
			2012-01-13 17:46:52
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Goran Soderstrom</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Well, on  my mac with Lion, there are three versions of python. If I type python2.5 I get python2.5, if I type python2.6, I get python 2.6. Here is a trace of execution:
<code>
% ls /usr/bin/python*
/usr/bin/python			/usr/bin/python2.5		/usr/bin/python2.6		/usr/bin/python2.7		/usr/bin/pythonw		/usr/bin/pythonw2.6
/usr/bin/python-config		/usr/bin/python2.5-config	/usr/bin/python2.6-config	/usr/bin/python2.7-config	/usr/bin/pythonw2.5		/usr/bin/pythonw2.7
</code>
You are not limited to python2.7 and to use the python fontforge module with a slightly modified mactools installation of fontforge, I have to use python2.6 (works on OS X 10.5 and OS X 10.7; have'nt tried yet on OS X 10.6). I know nothing of fontlab (don't want to pay just to answer questions on typophile).
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2012-01-13 17:55:15"
			itemprop="datePublished"
		>
			2012-01-13 17:55:15
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Michel Boyer</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Sorry, but I don‘t understand what to do. I just want TTX to work again. In the terminal. Nothing to do with FontLab.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2012-01-13 18:12:45"
			itemprop="datePublished"
		>
			2012-01-13 18:12:45
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Goran Soderstrom</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">First, then, do the <code>ls /usr/bin/python*</code> thing. Also, if your machine has <code>/usr/local/</code>, try <code>ls /usr/local/bin/python*</code> in case there is a Python interpreter lurking there.

Assuming you found, say, <code>/usr/bin/python2.5</code>: Say <code>python2.5 ttx foo.ttf</code> to check if it runs to completion. If <code>/usr/bin/python2.6</code> exists, try again with that.

Then, open the <code>ttx</code> script in a text editor and change the <code>#! /usr/bin/env python</code> (the sha-bang line) at the top to reflect the latest version that works. Save it, and you should be back to NERV's motto.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2012-01-13 18:59:58"
			itemprop="datePublished"
		>
			2012-01-13 18:59:58
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Té Rowan</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">I’m with you through here:

ls /usr/bin/python*

and gets:

/usr/bin/python			/usr/bin/python2.6		/usr/bin/pythonw
/usr/bin/python-config		/usr/bin/python2.6-config	/usr/bin/pythonw2.5
/usr/bin/python2.5		/usr/bin/python2.7		/usr/bin/pythonw2.6
/usr/bin/python2.5-config	/usr/bin/python2.7-config	/usr/bin/pythonw2.7

But, after that when I type:

python2.5 ttx foo.ttf

this happens:

python2.5: can't open file 'ttx': [Errno 2] No such file or directory

Same with 2.6.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2012-01-13 19:40:27"
			itemprop="datePublished"
		>
			2012-01-13 19:40:27
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Goran Soderstrom</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Hi Göran,

you need to edit one line in the fontTools source:

https://github.com/mcolyer/fonttools/commit/e732bd3ba63c51df9aed903eb2147fa1af1bfdc2

After that you need to run <code>sudo ./setup.py install</code> again in the fontTools folder.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2012-01-13 20:57:10"
			itemprop="datePublished"
		>
			2012-01-13 20:57:10
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Jens Kutilek</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Jens

Does that solve all problems? I see that the deprecated calls FSpOpenResFile and FSpCreateResFile are also used in the files 
<code>
./Lib/fontTools/fondLib.py ./Lib/fontTools/nfntLib.py ./Lib/fontTools/t1Lib.py ./Mac/TTX.py
</code>

Michel
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2012-01-13 21:09:41"
			itemprop="datePublished"
		>
			2012-01-13 21:09:41
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Michel Boyer</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">You're probably right, somebody should test fontTools thoroughly for stuff like this. As I understand it, it's a 64 bit issue, so the other way to avoid it is by switching Python to 32 bit by default:

 <code>defaults write com.apple.versioner.python Prefer-32-Bit -bool yes</code></div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2012-01-13 21:14:10"
			itemprop="datePublished"
		>
			2012-01-13 21:14:10
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Jens Kutilek</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Jens, do you know everything? :)

It worked! Thanks so much. Again.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2012-01-14 09:11:02"
			itemprop="datePublished"
		>
			2012-01-14 09:11:02
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Goran Soderstrom</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Ok well. It worked to *create* the TTX but when going back to the TTF I get this:

Parsing 'GlyphOrder' table...
Parsing 'head' table...
Parsing 'hhea' table...
Parsing 'maxp' table...
Parsing 'OS/2' table...
Parsing 'hmtx' table...
Parsing 'cmap' table...
Parsing 'fpgm' table...
Parsing 'prep' table...
Parsing 'cvt ' table...
Parsing 'loca' table...
Parsing 'glyf' table...
Parsing 'kern' table...
Parsing 'name' table...
Parsing 'post' table...
Parsing 'gasp' table...
Parsing 'GPOS' table...
Parsing 'GSUB' table...
Traceback (most recent call last):
  File "/usr/local/bin/ttx", line 11, in <module>
    ttx.main(sys.argv[1:])
  File "/Library/Python/2.7/site-packages/FontTools/fontTools/ttx.py", line 295, in main
    process(jobs, options)
  File "/Library/Python/2.7/site-packages/FontTools/fontTools/ttx.py", line 280, in process
    action(input, output, options)
  File "/Library/Python/2.7/site-packages/FontTools/fontTools/ttx.py", line 186, in ttCompile
    ttf.save(output)
  File "/Library/Python/2.7/site-packages/FontTools/fontTools/ttLib/__init__.py", line 201, in save
    self._writeTable(tag, writer, done)
  File "/Library/Python/2.7/site-packages/FontTools/fontTools/ttLib/__init__.py", line 597, in _writeTable
    tabledata = self.getTableData(tag)
  File "/Library/Python/2.7/site-packages/FontTools/fontTools/ttLib/__init__.py", line 609, in getTableData
    return self.tables[tag].compile(self)
  File "/Library/Python/2.7/site-packages/FontTools/fontTools/ttLib/tables/otBase.py", line 73, in compile
    self.table.compile(writer, font)
  File "/Library/Python/2.7/site-packages/FontTools/fontTools/ttLib/tables/otBase.py", line 616, in compile
    conv.write(writer, font, tableStack, value)
  File "/Library/Python/2.7/site-packages/FontTools/fontTools/ttLib/tables/otConverters.py", line 185, in write
    value.compile(subWriter, font, tableStack)
  File "/Library/Python/2.7/site-packages/FontTools/fontTools/ttLib/tables/otBase.py", line 604, in compile
    conv.write(writer, font, tableStack, value[i], i)
  File "/Library/Python/2.7/site-packages/FontTools/fontTools/ttLib/tables/otConverters.py", line 185, in write
    value.compile(subWriter, font, tableStack)
  File "/Library/Python/2.7/site-packages/FontTools/fontTools/ttLib/tables/otBase.py", line 604, in compile
    conv.write(writer, font, tableStack, value[i], i)
  File "/Library/Python/2.7/site-packages/FontTools/fontTools/ttLib/tables/otConverters.py", line 185, in write
    value.compile(subWriter, font, tableStack)
  File "/Library/Python/2.7/site-packages/FontTools/fontTools/ttLib/tables/otBase.py", line 590, in compile
    table = self.preWrite(font)
  File "/Library/Python/2.7/site-packages/FontTools/fontTools/ttLib/tables/otTables.py", line 186, in preWrite
    gidItems = [(getGlyphID(item[0]), getGlyphID(item[1])) for item in items]
  File "/Library/Python/2.7/site-packages/FontTools/fontTools/ttLib/__init__.py", line 548, in getGlyphID
    raise KeyError, glyphName
KeyError: 'glyph65535'

And it only seem to be happening on some fonts I now realized. Must be something wrong with the font perhaps? It’s a TTF generated from Fontlab 5.1.

</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2012-01-14 09:27:59"
			itemprop="datePublished"
		>
			2012-01-14 09:27:59
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Goran Soderstrom</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><em>Jens, do you know everything? :)</em>

I'm working on it ;)

<em>KeyError: 'glyph65535'</em>

65535 or 2¹⁶ − 1 is the maximum glyph index in OpenType fonts.

This error is usually because of a glyph being referenced in an OT feature but missing from the font. The error is in the GSUB table here, so I'd check the classes and substitution features for missing glyphs.
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2012-01-14 15:50:17"
			itemprop="datePublished"
		>
			2012-01-14 15:50:17
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Jens Kutilek</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">That is due to the fact that the python that comes installed on the mac is ucs-2 and not ucs-4. Here is a trace of execution on my mac (python2.5, python2.6 and python2.7 in /usr/bin do the same):
<code>
501 % /usr/bin/python -c "import sys; print sys.maxunicode;"
65535
502 % /opt/local/bin/python -c "import sys; print sys.maxunicode;"
1114111
503 % 
</code>
I installed a ucs-4 python (2.6) with macports to use with fontforge to handle glyphs above 0xFFFF.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2012-01-14 16:26:49"
			itemprop="datePublished"
		>
			2012-01-14 16:26:49
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Michel Boyer</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Jens! Hero! You were right again!

For some reason the font could be generated even though a glyph was represented in the code (but not in the font).

I’m happy.

Beer’s on me.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2012-01-14 17:06:14"
			itemprop="datePublished"
		>
			2012-01-14 17:06:14
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Goran Soderstrom</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">&gt;<cite>&nbsp;&nbsp; 65535 or 2¹⁶ − 1 is the maximum glyph index in OpenType fonts</cite>
Sorry, I had misread your comment. GlyphID is indeed 16 bits.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2012-01-15 12:56:28"
			itemprop="datePublished"
		>
			2012-01-15 12:56:28
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Michel Boyer</span
			></span
		>
	</div>
	
</div>
 
</article>

    </main>
    
  </body>
</html>
