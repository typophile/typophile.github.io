<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<title>Macro - Copy to Composites | Typophile Archive</title>
<meta name=viewport content="width=device-width,minimum-scale=1">
<meta name=description content>
<meta name=generator content="Hugo 0.91.2">
<meta name=robots content="noindex, nofollow">
<link href=https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3 crossorigin=anonymous>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js integrity=sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p crossorigin=anonymous></script>
<meta property="og:title" content="Macro - Copy to Composites">
<meta property="og:description" content>
<meta property="og:type" content="article">
<meta property="og:url" content="http://typophile.github.io/node/40232/"><meta property="article:section" content="node">
<meta property="article:published_time" content="2007-12-20T11:20:58+00:00">
<meta property="article:modified_time" content="2007-12-20T11:20:58+00:00">
<meta itemprop=name content="Macro - Copy to Composites">
<meta itemprop=description content><meta itemprop=datePublished content="2007-12-20T11:20:58+00:00">
<meta itemprop=dateModified content="2007-12-20T11:20:58+00:00">
<meta itemprop=wordCount content="0">
<meta itemprop=keywords content><meta name=twitter:card content="summary">
<meta name=twitter:title content="Macro - Copy to Composites">
<meta name=twitter:description content>
</head>
<body class="ma0 avenir bg-near-white">
<header>
<nav class="navbar navbar-expand-lg navbar-light bg-light">
<div class=container>
<a class=navbar-brand href=/>Typophile Archive</a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span>
</button>
</div>
</nav>
</header>
<main class=pb7 role=main>
<article class=container>
<header class="post-header py-3">
<h1 class="post-title p-name" itemprop="name headline">Macro - Copy to Composites</h1>
<p class=text-muted>
<time class="f6 mv4 dib tracked" datetime=2007-12-20T11:20:58Z>December 20, 2007</time>
• <span itemprop=author itemscope itemtype=http://schema.org/Person>
<span class="p-author h-card" itemprop=name>RachelR</span></span>
</p>
</header>
<div class="post-content e-content" itemprop=articleBody>Hi all,
I'm to write a script to use with RoboFab that will work like the fontlab function "Copy to composites" from the preview window when a glyph is used in other composites.
[img:sites/default/files/old-images/Picture-1_3595.gif]
This fiunction works fine but I was trying to produce something that would update all the metrics in composites in on go without having to go through each glyph.
I thought something like this might work,
<code>
#---------------------------
#UPDATE COMPONENT METRICS
#---------------------------
from robofab.world import CurrentFont
f = CurrentFont()
f['Itilde'].leftMargin = f['I'].leftMargin
f['Imacron'].leftMargin = f['I'].leftMargin
f['Ibreve'].leftMargin = f['I'].leftMargin
f['Iacute'].leftMargin = f['I'].leftMargin
f['Icircumflex'].leftMargin = f['I'].leftMargin
f['Idieresis'].leftMargin = f['I'].leftMargin
f['Igrave'].leftMargin = f['I'].leftMargin
f['Idotaccent'].leftMargin = f['I'].leftMargin
f['Itilde'].rightMargin = f['I'].rightMargin
f['Imacron'].rightMargin = f['I'].rightMargin
f['Ibreve'].rightMargin = f['I'].rightMargin
f['Iacute'].rightMargin = f['I'].rightMargin
f['Icircumflex'].rightMargin = f['I'].rightMargin
f['Idieresis'].rightMargin = f['I'].rightMargin
f['Igrave'].rightMargin = f['I'].rightMargin
f['Idotaccent'].rightMargin = f['I'].rightMargin
f.update()
</code>
This produces sidebearings including the added accents in the case of the Itilde, Imacron etc.
When using the Copy to Composites function in FL it produces the correct sidebearings with the accents, as can be seen with the measurement line.
What I wanted is someway of applying the copy to composites function to all composites.
[img:sites/default/files/old-images/Picture-2_4690.gif]</div>
<div class="comment card m-3">
<div class=card-body>
<div class=commentbody>A quicker way is to rebuild your accented glyphs with the f.generateGlyph() method since it will copy the metrics of the baseglyph. Just select the glyphs you want to update and run this script:
<code>
#FLM: Build accents
from robofab.world import CurrentFont, CurrentGlyph
from robofab.interface.all.dialogs import ProgressBar
f = CurrentFont()
def buildAccents(f, g):
--> f.generateGlyph(g.name, replace=True, printErrors=True)
--> g.update()
if f:
--> if f.selection:
--> --> l = f.selection
--> else:
--> --> l = f.keys()
--> bar = ProgressBar('Building accents...', len(l))
--> for n in l:
--> --> g = f[n]
--> --> buildAccents(f, g)
--> --> bar.tick()
--> bar.close()
--> print "Accents for glyphs " + str(l) + " built"
--> f.update()
--> print ""
</code>
(replace the arrows with a tab to get proper Python syntax)
:)</div>
</div>
<div class="card-footer text-muted post-meta text-end">
<time class=dt-published datetime="2007-12-20 12:14:31" itemprop=datePublished>
2007-12-20 12:14:31
</time>
•
<span itemprop=author itemscope itemtype=http://schema.org/Person>
<span class="p-author h-card" itemprop=name>pvanderlaan</span></span>
</div>
</div>
<div class="comment card m-3">
<div class=card-body>
<div class=commentbody>but robofab's accent builder assumes the designer is using <a href=http://typophile.com/node/39404>anchors</a>, right?
;-)</div>
</div>
<div class="card-footer text-muted post-meta text-end">
<time class=dt-published datetime="2007-12-20 16:11:58" itemprop=datePublished>
2007-12-20 16:11:58
</time>
•
<span itemprop=author itemscope itemtype=http://schema.org/Person>
<span class="p-author h-card" itemprop=name>gferreira</span></span>
</div>
</div>
<div class="comment card m-3">
<div class=card-body>
<div class=commentbody>Yes, this RoboFab method requires the use of anchors. Which I think is almost vital if you're dealing with many accented glyphs.</div>
</div>
<div class="card-footer text-muted post-meta text-end">
<time class=dt-published datetime="2007-12-21 12:32:55" itemprop=datePublished>
2007-12-21 12:32:55
</time>
•
<span itemprop=author itemscope itemtype=http://schema.org/Person>
<span class="p-author h-card" itemprop=name>pvanderlaan</span></span>
</div>
</div>
</article>
</main>
</body>
</html>