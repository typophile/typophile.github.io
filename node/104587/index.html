<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>How do you (programmatically) move truetype points around?  | Typophile Archive</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="">
    <meta name="generator" content="Hugo 0.91.2" />
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

    <meta property="og:title" content="How do you (programmatically) move truetype points around? " />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://typophile.github.io/node/104587/" /><meta property="article:section" content="node" />
<meta property="article:published_time" content="2013-07-13T03:21:15+00:00" />
<meta property="article:modified_time" content="2013-07-13T03:21:15+00:00" />

<meta itemprop="name" content="How do you (programmatically) move truetype points around? ">
<meta itemprop="description" content=""><meta itemprop="datePublished" content="2013-07-13T03:21:15+00:00" />
<meta itemprop="dateModified" content="2013-07-13T03:21:15+00:00" />
<meta itemprop="wordCount" content="0">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="How do you (programmatically) move truetype points around? "/>
<meta name="twitter:description" content=""/>

  </head>

  <body class="ma0 avenir bg-near-white">

      <header>
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container">
      <a class="navbar-brand" href="/">Typophile Archive</a>
      <button
        class="navbar-toggler"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
  </nav>
</header>
 
    <main class="pb7" role="main">
      
<article class="container">
  <header class="post-header py-3">
    <h1 class="post-title p-name" itemprop="name headline">How do you (programmatically) move truetype points around? </h1>
    <p class="text-muted">
              
      <time class="f6 mv4 dib tracked" datetime="2013-07-13T03:21:15Z">July 13, 2013</time>
      
        
          • <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Michel Boyer</span></span>
      

    </p>
  </header>
  <div class="post-content e-content" itemprop="articleBody">In the thread http://typophile.com/node/103643, a question was raised that can be reformulated as follows: "how can one build the latin small letter alpha?", which is uni0251 (in the IPA extensions). Even with a serif font, its lower part appears to be that of a d and its upper part that of a q. My question here is how to do that programmatically.
<!--break-->
The intent, in the tread above, was to get the corresponding glyph for the Roboto fonts. The question is interesting because with Roboto, in all fonts, the d and the q have the same number of truetype points, and they are numbered similarly. In order to get the "latin small letter alpha" in the middle below, I took a d and then moved the points  6, 7 and 8 at the coordinates they have in the letter q. 
[img:sites/default/files/old-images/daq-Black3_4307.png]
I could in fact do that editing (with a script) the ttx files. I found no way to do it (programmatically) with FontForge. I can only get a copy of the contours, the modifications are not reflected in the font. I found no way to access those points in the font tools. How can you do that (programmatically, I mean) with your professional tools (even if it is not really worth the trouble for this particular example). Is that easy to do with Glyphs?</div>

   <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">In FontLab I'm sure Python can do it.

hhp
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2013-07-13 04:59:13"
			itemprop="datePublished"
		>
			2013-07-13 04:59:13
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>hrant</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">In RoboFont this would do:

<pre>f = CurrentFont()
f["a"] = f["q"] & f["d"]</pre>

... but only because RoboFont has implemented the Boolean operators (in this case &, «and») for glyph operations. I don’t know if other editors have similar options.

[img:sites/default/files/old-images/glyphmath_4041.png]

The result would still need some manual cleaning though:

[img:sites/default/files/old-images/glyphmath-a_3734.png]

Edit: This only seems to work with PS curves, not TT curves.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2013-07-13 08:44:38"
			itemprop="datePublished"
		>
			2013-07-13 08:44:38
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Jens Kutilek</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">If the point indices are the same, and known, this would work in any Robofab environment:

<pre>
f = CurrentFont()
f["a"] = f["d"].copy()

# contour 0, segment 1, point 2
f["a"][0][1][2].x = f["q"][0][1][2].x
f["a"][0][1][2].y = f["q"][0][1][2].y

# contour 0, segment 2, point 0
f["a"][0][2][0].x = f["q"][0][2][0].x
f["a"][0][2][0].y = f["q"][0][2][0].y

# contour 0, segment 3, point 0
f["a"][0][3][0].x = f["q"][0][3][0].x
f["a"][0][3][0].y = f["q"][0][3][0].y
</pre>

but in practice it doesn’t because in Roboto the q is narrower than the d, so the right side of the new «a» won’t end up vertical.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2013-07-13 08:59:05"
			itemprop="datePublished"
		>
			2013-07-13 08:59:05
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Jens Kutilek</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Jens, I can do the intersection with a native FontForge script (but not with an assignment as you did). Here is what I get with the medium weight:

<img src="/files/lalphamedium_3458.png">

There is too much cleaning to do.

The Robofab code of your second post is exactly the type of code I had in mind. As for the right side, there is no need to change the x coordinate, changing the y coordinate fixes the height and then the right side stays vertical.

Is that something that can be programmed as a tool to be used in a GUI environment, so that corrections can then be made on the fly?</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2013-07-13 13:13:55"
			itemprop="datePublished"
		>
			2013-07-13 13:13:55
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Michel Boyer</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">You can certainly create the GUI in vanilla, but the complexity of the script increases the more corrections you want to enable, obviously. You could actually do this outside of Fontlab using defcon, but I don't think there's an advantage to that.

Jason C</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2013-07-14 03:26:10"
			itemprop="datePublished"
		>
			2013-07-14 03:26:10
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>jasonc</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">After all, it is unclear I would gain much with Robofab; to create a new character, I can do something fairly close to the code above, but I need to use the pen to draw (or redraw) the character; here is something that works from the Fontforge script menu and creates uni0251 for Roboto.
<PRE>
f=fontforge.activeFont()
ld=f["d"].foreground
lq=f["q"].foreground
# Contour 0, point 6
ld[0][6].x = lq[0][6].x
ld[0][6].y = lq[0][6].y
# Contour 0, point 7
ld[0][7].x = lq[0][7].x
ld[0][7].y = lq[0][7].y
# Contour 0, point 8
ld[0][8].y = lq[0][8].y
# Create the new character
f.createChar(0x0251,"uni0251")
# Draw the modified layer ld
pen=f["uni0251"].glyphPen()
ld.draw(pen)
pen=None
f["uni0251"].width = f["d"].width
</PRE>
Since <code>ld</code> is only a copy, the character d is left unchanged.

Added: to get the same numbering for the points in the resulting glyph, I have to draw contour 1 before contour 0. So it is
<PRE>
ld[1].draw(pen);  ld[0].draw(pen)
</PRE>
instead of <code>ld.draw(pen)</code>. (weird!)

Of course, for the italic, we need to calculate the x coordinate of point 8. To cover all cases we thus need to add something like
<PRE>
m=(ld[0][8].x -ld[0][9].x)*1.0/(ld[0][8].y-ld[0][9].y)
ld[0][8].x =ld[0][9].x + (lq[0][8].y-ld[0][9].y)*m
</PRE>
before <code>ld[0][8].y = lq[0][8].y</code>. This works fine even for the thin italic where there are four points between the top and the bottom of the right part of the d and q.

Here is the picture with d (green) in the background. 
[img:sites/default/files/old-images/segment-9-10_5148.png]
Points 9 and 10 are very close. The value of m above is the slope of the segment 8-9 when x is seen as a function of y.

Correction: there are two other points close to 9; there is thus a 9,10,11 cluster and then a 12,13,14 cluster. Hmm, no! I looked closer and there is a cluster of four points, 9,10,11,12 and then two point 13,14</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2013-07-15 02:35:13"
			itemprop="datePublished"
		>
			2013-07-15 02:35:13
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Michel Boyer</span
			></span
		>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Robofab wouldn’t gain you anything indeed, it is just the environment that I’m most proficient in at the moment, and it’s not confined to a specific editor.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2013-07-15 11:39:46"
			itemprop="datePublished"
		>
			2013-07-15 11:39:46
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">
			<span class="p-author h-card" itemprop="name"
				>Jens Kutilek</span
			></span
		>
	</div>
	
</div>
 
</article>

    </main>
    
  </body>
</html>
