---
author:
  name: Frode Bo Helland
  picture: 112295
body: "I have a code that recognizes numbers with brackets around them ([1], [22]
  and [333]) and exchange the numbers and brackets with alternate forms that together
  form a sort of indexed number: a square around the numbers. I make use of a class
  called @figures to detect any kind of numeral. Singles and doubles are quadratic,
  the triples doesn\u2019t need to be, so they use the same numbers as the doubles.\r\n\r\nHere\u2019s
  the code (I have a similar one for inversed squares in ss02):\r\n<code>\r\nfeature
  ss01 {\r\n  lookup mono_1 {\r\n  \tsub bracketleft @figures bracketright' by bracketright.square;\r\n\t}
  mono_1; \r\n\tlookup mono_2 {\r\n\t\tsub bracketleft zero' bracketright.square by
  zero.mono;\r\n\t\tsub bracketleft one' bracketright.square by one.mono;\r\n\t\tsub
  bracketleft two' bracketright.square by two.mono;\r\n\t\tsub bracketleft three'
  bracketright.square by three.mono;\r\n\t\tsub bracketleft four' bracketright.square
  by four.mono;\r\n\t\tsub bracketleft five' bracketright.square by five.mono;\r\n\t\tsub
  bracketleft six' bracketright.square by six.mono;\r\n\t\tsub bracketleft seven'
  bracketright.square by seven.mono;\r\n\t\tsub bracketleft eight' bracketright.square
  by eight.mono;\r\n\t\tsub bracketleft nine' bracketright.square by nine.mono;\r\n\t}
  mono_2; \r\n\tlookup mono_3 {\r\n\t\tsub bracketleft' @figures bracketright.square
  by bracketleft.square;\r\n\t} mono_3; \r\n\t\r\n\tlookup duo_1 {\r\n\t\tsub bracketleft
  @figures @figures bracketright' by bracketright.square;\r\n\t} duo_1; \r\n\tlookup
  duo_2 {\r\n\t\tsub bracketleft @figures zero' bracketright.square by zero.multiple;\r\n\t\tsub
  bracketleft @figures one' bracketright.square by one.multiple;\r\n\t\tsub bracketleft
  @figures two' bracketright.square by two.multiple;\r\n\t\tsub bracketleft @figures
  three' bracketright.square by three.multiple;\r\n\t\tsub bracketleft @figures four'
  bracketright.square by four.multiple;\r\n\t\tsub bracketleft @figures five' bracketright.square
  by five.multiple;\r\n\t\tsub bracketleft @figures six' bracketright.square by six.multiple;\r\n\t\tsub
  bracketleft @figures seven' bracketright.square by seven.multiple;\r\n\t\tsub bracketleft
  @figures eight' bracketright.square by eight.multiple;\r\n\t\tsub bracketleft @figures
  nine' bracketright.square by nine.multiple;\r\n\t} duo_2; \r\n\t\r\n\tlookup duo_3
  {\r\n\t\tsub bracketleft zero' @figures bracketright.square by zero.multiple;\r\n\t\tsub
  bracketleft one' @figures bracketright.square by one.multiple;\r\n\t\tsub bracketleft
  two' @figures bracketright.square by two.multiple;\r\n\t\tsub bracketleft three'
  @figures bracketright.square by three.multiple;\r\n\t\tsub bracketleft four' @figures
  bracketright.square by four.multiple;\r\n\t\tsub bracketleft five' @figures bracketright.square
  by five.multiple;\r\n\t\tsub bracketleft six' @figures bracketright.square by six.multiple;\r\n\t\tsub
  bracketleft seven' @figures bracketright.square by seven.multiple;\r\n\t\tsub bracketleft
  eight' @figures bracketright.square by eight.multiple;\r\n\t\tsub bracketleft nine'
  @figures bracketright.square by nine.multiple;\r\n\t} duo_3; \r\n\tlookup duo_4
  {\r\n\t\tsub bracketleft' @figures @figures bracketright.square by bracketleft.square;\r\n\t}
  duo_4;\r\n\t\r\n\t\r\n\t\r\n\t\r\n\tlookup trio_1 {\r\n\t\tsub bracketleft @figures
  @figures @figures bracketright' by bracketright.square;\r\n\t} trio_1; \r\n\tlookup
  trio_2 {\r\n\t\tsub bracketleft @figures @figures zero' bracketright.square by zero.multiple;\r\n\t\tsub
  bracketleft @figures @figures one' bracketright.square by one.multiple;\r\n\t\tsub
  bracketleft @figures @figures two' bracketright.square by two.multiple;\r\n\t\tsub
  bracketleft @figures @figures three' bracketright.square by three.multiple;\r\n\t\tsub
  bracketleft @figures @figures four' bracketright.square by four.multiple;\r\n\t\tsub
  bracketleft @figures @figures five' bracketright.square by five.multiple;\r\n\t\tsub
  bracketleft @figures @figures six' bracketright.square by six.multiple;\r\n\t\tsub
  bracketleft @figures @figures seven' bracketright.square by seven.multiple;\r\n\t\tsub
  bracketleft @figures @figures eight' bracketright.square by eight.multiple;\r\n\t\tsub
  bracketleft @figures @figures nine' bracketright.square by nine.multiple;\r\n\t}
  trio_2; \r\n\tlookup trio_3 {\r\n\t\tsub bracketleft @figures zero' @figures bracketright.square
  by zero.multiple;\r\n\t\tsub bracketleft @figures one' @figures bracketright.square
  by one.multiple;\r\n\t\tsub bracketleft @figures two' @figures bracketright.square
  by two.multiple;\r\n\t\tsub bracketleft @figures three' @figures bracketright.square
  by three.multiple;\r\n\t\tsub bracketleft @figures four' @figures bracketright.square
  by four.multiple;\r\n\t\tsub bracketleft @figures five' @figures bracketright.square
  by five.multiple;\r\n\t\tsub bracketleft @figures six' @figures bracketright.square
  by six.multiple;\r\n\t\tsub bracketleft @figures seven' @figures bracketright.square
  by seven.multiple;\r\n\t\tsub bracketleft @figures eight' @figures bracketright.square
  by eight.multiple;\r\n\t\tsub bracketleft @figures nine' @figures bracketright.square
  by nine.multiple;\r\n\t} trio_3; \r\n\tlookup trio_4 {\r\n\t\tsub bracketleft zero'
  @figures @figures bracketright.square by zero.multiple;\r\n\t\tsub bracketleft one'
  @figures @figures bracketright.square by one.multiple;\r\n\t\tsub bracketleft two'
  @figures @figures bracketright.square by two.multiple;\r\n\t\tsub bracketleft three'
  @figures @figures bracketright.square by three.multiple;\r\n\t\tsub bracketleft
  four' @figures @figures bracketright.square by four.multiple;\r\n\t\tsub bracketleft
  five' @figures @figures bracketright.square by five.multiple;\r\n\t\tsub bracketleft
  six' @figures @figures bracketright.square by six.multiple;\r\n\t\tsub bracketleft
  seven' @figures @figures bracketright.square by seven.multiple;\r\n\t\tsub bracketleft
  eight' @figures @figures bracketright.square by eight.multiple;\r\n\t\tsub bracketleft
  nine' @figures @figures bracketright.square by nine.multiple;\r\n\t} trio_4; \r\n\tlookup
  trio_5 {\r\n\t\tsub bracketleft' @figures @figures @figures bracketright.square
  by bracketleft.square;\r\n\t} trio_5; \t \r\n} ss01;\r\n</code>\r\n\r\nThis works
  like a charm, I\u2019m just wondering if I could simplify things somehow."
comments:
- author:
    name: Frode Bo Helland
    picture: 112295
  body: "And, another question while I\u2019m at it. If I kern a glyph to overlap
    another, is there some way to make sure the overlap will be knocked out? It\u2019s
    easily done with multiple shapes inside a glyph (ex: the inner shape of O is knocked
    out of the outer)."
  created: '2010-06-23 13:15:22'
- author:
    name: Frode Bo Helland
    picture: 112295
  body: "Actually. This does not work as a charm, at least not in the application
    my client use to design: Word 2010. I\u2019m not sure why."
  created: '2010-06-23 13:54:14'
- author:
    name: Arno Enslin
    picture: 117576
  body: "&lt;code&gt;CODE&lt;/code&gt;\r\nempty line\r\n&lt;code&gt;CODE&lt;/code&gt;\r\n\r\n--------\r\n\r\nWould
    be easier to comprehend, if you would post a few images of the singles, the doubles
    and the tripples (after substitution)."
  created: '2010-06-23 19:14:35'
- author:
    name: Frode Bo Helland
    picture: 112295
  body: "Thanks for responding, Arno. It was just an uninstalled old version of the
    font that caused problems in Word. The image below shows what I\u2019m doing:
    \r\n\r\n[img:sites/default/files/old-images/Indexed-Numerals_5939.png]\r\n\r\nEverything
    is working now, but the code feels rather heavy.\r\n\r\nAlso, the frames are built
    from parts and the rendering of each part sometimes differs (only on screen).
    That\u2019s the reason I\u2019m asking about overlapping shapes. It would be so
    much easier if I could just keep the rectangles as whole shapes and kern them
    in place instead of piecing them together."
  created: '2010-06-25 00:46:25'
- author:
    name: Igor Freiberger
    picture: 115255
  body: "Frode,\r\n\r\nyou can simplify the code creating a class with all the alternate
    figures (I called this @figalts) and rearranging the lookups this way:\r\n\r\n<code>\r\nfeature
    ss01 {\r\n lookup figthree {\r\n  sub bracketleft @figures @figures zero' by zero.multiple;\r\n
    \ sub bracketleft @figures @figures one' by one.multiple;\r\n  sub bracketleft
    @figures @figures two' by two.multiple;\r\n  sub bracketleft @figures @figures
    three' by three.multiple;\r\n  sub bracketleft @figures @figures four' by four.multiple;\r\n
    \ sub bracketleft @figures @figures five' by five.multiple;\r\n  sub bracketleft
    @figures @figures six' by six.multiple;\r\n  sub bracketleft @figures @figures
    seven' by seven.multiple;\r\n  sub bracketleft @figures @figures eight' by eight.multiple;\r\n
    \ sub bracketleft @figures @figures nine' by nine.multiple;\r\n } figthree;\r\n</code><code>\r\n
    lookup figtwo {\r\n  sub bracketleft @figures zero' by zero.multiple;\r\n  sub
    bracketleft @figures one' by one.multiple;\r\n  sub bracketleft @figures two'
    by two.multiple;\r\n  sub bracketleft @figures three' by three.multiple;\r\n  sub
    bracketleft @figures four' by four.multiple;\r\n  sub bracketleft @figures five'
    by five.multiple;\r\n  sub bracketleft @figures six' by six.multiple;\r\n  sub
    bracketleft @figures seven' by seven.multiple;\r\n  sub bracketleft @figures eight'
    by eight.multiple;\r\n  sub bracketleft @figures nine' backetright by nine.multiple;\r\n
    } figtwo;\r\n</code><code>\r\n lookup figone {\r\n  sub bracketleft zero' @figalts
    by zero.multiple;\r\n  sub bracketleft one' @figalts by one.multiple;\r\n  sub
    bracketleft two' @figalts by two.multiple;\r\n  sub bracketleft three' @figalts
    by three.multiple;\r\n  sub bracketleft four' @figalts by four.multiple;\r\n  sub
    bracketleft five' @figalts by five.multiple;\r\n  sub bracketleft six' @figalts
    \ by six.multiple;\r\n  sub bracketleft seven' @figalts by seven.multiple;\r\n
    \ sub bracketleft eight' @figalts by eight.multiple;\r\n  sub bracketleft nine'
    @figalts by nine.multiple;\r\n } figtone;\r\n</code><code>\r\n lookup figmono
    {\r\n  sub bracketleft zero' backetright by zero.mono;\r\n  sub bracketleft one'
    backetright by one.mono;\r\n  sub bracketleft two' backetright by two.mono;\r\n
    \ sub bracketleft three' backetright by three.mono;\r\n  sub bracketleft four'
    backetright by four.mono;\r\n  sub bracketleft five' backetright by five.mono;\r\n
    \ sub bracketleft six' backetright by six.mono;\r\n  sub bracketleft seven' backetright
    by seven.mono;\r\n  sub bracketleft eight' backetright by eight.mono;\r\n  sub
    bracketleft nine' backetright by nine.mono;\r\n } figmono;\r\n</code><code>\r\n
    lookup left {\r\n  sub bracketleft' @figalts by bracketleft.square;\r\n } left;\r\n</code><code>\r\n
    lookup right {\r\n  sub @figalts bracketright' by bracketright.square;\r\n } right;\r\n}
    ss01;\r\n</code>\r\n\r\nAs you can see, @figalts was created just to permit the
    replacement in an easier way.\r\n\r\nThis code has a problem: it will change any
    text between brackets and beginning with two or three numbers, what may not be
    desired. Your original code also permits undesired substitution, although it restricts
    the field to [<em>1-3</em>x].\r\n\r\nAs this is a stylistic set, the user probably
    will apply it throught a character style. So, he/she will hardly get undesired
    substitutions. If this is an issue, you can adopt another standard to indicate
    indexed numbers (as two brackets instead of one) and reduce to near zero the possibility
    to get wrong results.\r\n\r\n[I have no time to test this code now, but I plan
    to do this soon.]"
  created: '2010-06-25 05:24:12'
- author:
    name: Arno Enslin
    picture: 117576
  body: "@ Frode and Freiberger\r\n\r\nInstead of a list like this\r\n\r\n<code>sub
    bracketleft @figures @figures zero' by zero.multiple;\r\nsub bracketleft @figures
    @figures one' by one.multiple;\r\nsub bracketleft @figures @figures two' by two.multiple;\r\nsub
    bracketleft @figures @figures three' by three.multiple;\r\nsub bracketleft @figures
    @figures four' by four.multiple;\r\nsub bracketleft @figures @figures five' by
    five.multiple;\r\nsub bracketleft @figures @figures six' by six.multiple;\r\nsub
    bracketleft @figures @figures seven' by seven.multiple;\r\nsub bracketleft @figures
    @figures eight' by eight.multiple;\r\nsub bracketleft @figures @figures nine'
    by nine.multiple;</code>\r\n\r\nyou simply could write\r\n\r\n<code>sub bracketleft
    @figures @figures @figures' by @figures_Multiple</code>\r\n\r\nThis only requires,
    that the order is the same in @figures and @figures_Multiple.\r\n\r\n<cite>It
    would be so much easier if I could just keep the rectangles as whole shapes and
    kern them in place instead of piecing them together.</cite>\r\n\r\nIn this case
    you would replace the bracketleft by the whole square and the bracketright by
    a glyph with a width of zero? This should work, especially because not the outlines
    would overlap, but the glyphs only. But you even would not need kerning, if the
    square had a negative right sidebearing. You would need two squares. One for the
    singles and doubles and one for the triples.\r\n\r\nI assume, that your multiple
    and mono figures are actually over- and underlined. Correct?\r\n\r\nEdited:\r\n\r\nMisunderstanding.
    You mean the overlapping of the outlines of the brackets, right? This can indeed
    be avoided by replacing the left or the right bracket with a square and the other
    by an empty character with a width of zero.\r\n\r\n<code>sub bracketleft @figures'
    bracketright by @figures_mono;\r\nsub bracketleft @figures @figures @figures'
    bracketright by @figures_multiple;\r\nsub bracketleft @figures @figures' bracketright
    by @figures_multiple;\r\nsub bracketleft @figures' bracketright by @figures_multiple;\r\nsub
    bracketleft' @figures_multiple @figures_multiple @figures_multiple by bracketleft.rectangle;\r\nsub
    bracketleft' [@figures_mono @figures_multiple] by bracketleft.quadrat;\r\nsub
    [@figures_mono @figures_multiple] bracketright' by bracketright.EmptyAndZeroWidth;</code>\r\n\r\nbracketleft.quadrat
    and bracketleft.rectangle have a negative right sidebearing, that is almost as
    big as their width (exclusively the left sidebearing).\r\n\r\n"
  created: '2010-06-25 09:11:30'
- author:
    name: Arno Enslin
    picture: 117576
  body: "@ Freiberger\r\n\r\nI made a mistake in my code. I don\u2019t think, that
    it would work, but I could correct it. But with the code from your last message
    I think, it is not needed anymore.\r\n\r\n<cite>I think this is not viable because
    one cannot center the numbers to the square size</cite>\r\n\r\nThe multiple figures
    are smaller than the single figures. I think, you are right, if the figures are
    not monospaced.\r\n\r\n"
  created: '2010-06-25 11:30:19'
- author:
    name: Igor Freiberger
    picture: 115255
  body: "You're right, Arno. After defining @figures_mono and @figures_multiple we
    get a much smaller, elegant code:\r\n\r\n<code>feature ss01 {\r\nlookup figthree
    {\r\nsub bracketleft @figures @figures @figures' by @figures_multiple;\r\n} figthree;\r\n</code><code>\r\nlookup
    figtwo {\r\nsub bracketleft @figures @figures' by @figures_multiple;\r\n} figtwo;\r\n</code><code>\r\nlookup
    figone {\r\nsub bracketleft @figures' @figures_multiple by @figures_multiple;\r\n}
    figtone;\r\n</code><code>\r\nlookup figmono {\r\nsub bracketleft @figures' backetright
    by @figures_mono;\r\n} figmono;\r\n</code><code>\r\nlookup left {\r\nsub bracketleft'
    @figures_multiple by bracketleft.square;\r\nsub bracketleft' @figures_mono by
    bracketleft.square;\r\n} left;\r\n</code><code>\r\nlookup right {\r\nsub @figures_multiple
    bracketright' by bracketright.square;\r\nsub @figures_mono bracketright' by bracketright.square;\r\n}
    right;\r\n} ss01;\r\n</code>\r\n\r\nThe overlapping idea is also possible, although
    I'd preffer the code above. It seems to be more complex to handle overlapping
    squares and numbers than to do straigthforward replacements."
  created: '2010-06-25 11:30:24'
- author:
    name: Igor Freiberger
    picture: 115255
  body: Arno, I edited my post and removed the observation about your overlapping
    code because I'm unsure if this is really not viable. Actually, I <em>guess</em>
    it's really possible, although more difficult to manage. I must do some tests
    before make this kind of assestment, sorry.
  created: '2010-06-25 11:33:33'
- author:
    name: Arno Enslin
    picture: 117576
  body: "@ Freiberger\r\n\r\nI think, that overlapping is problematical, if outlines
    overlap. For a few programs this may be problematical. But in my concept outlines
    are not overlapping. You could copy the square outline to a figure in FontLab
    and it would work. Path directions had not to be changed.\r\n\r\nI must logout
    now, but I will have a look on that thread later again."
  created: '2010-06-25 11:43:04'
- author:
    name: Frode Bo Helland
    picture: 112295
  body: "I have to digest these codes to see if I understand them :) Thanks! \r\n\r\nYes,
    the \u201Coutlined\u201D numbers are over- and underlined. A square with negative
    sidebearing would work like a charm, but I can\u2019t get the inversed numbers
    knocked out."
  created: '2010-06-25 11:46:36'
- author:
    name: Arno Enslin
    picture: 117576
  body: "Correction of my code at the bottom of the post, that I wrote 1.11am.\r\n\r\n<code>sub
    bracketleft @figures' bracketright by @figures_mono;\r\nsub bracketleft @figures
    @figures @figures' bracketright by @figures_multiple;\r\nsub bracketleft @figures
    @figures' bracketright by @figures_multiple;\r\nsub @figures @figures' figures_multiple
    by @figures_multiple;\r\nsub @figures' figures_multiple by @figures_multiple;\r\nsub
    bracketleft' @figures_multiple @figures_multiple @figures_multiple by bracketleft.rectangle;\r\nsub
    bracketleft' [@figures_mono @figures_multiple] by bracketleft.quadrat;\r\nsub
    [@figures_mono @figures_multiple] bracketright' by bracketright.EmptyAndZeroWidth;</code>\r\n\r\nI
    prefer coding, when I can test the code, but I am too lazy for creating a font
    just for testing code. I wanted to avoid, that figures are substituted, that are
    in context of more than two other figures. And it would be possible to create
    a code for the invers feature.\r\n\r\nHowever, I think the principle is clear
    enough. And maybe it already was a help, that you can put classes in brackets
    for building another set or that you can substitute classes. This probably does
    not work only in the features, but also, when you define classes. This was missing
    in the beginning, at least partly.\r\n\r\nBy the way, why are the lookups in your
    code?"
  created: '2010-06-25 18:25:07'
- author:
    name: Arno Enslin
    picture: 117576
  body: "<code>feature ss01 {\r\nfeatureNames {\r\nname \"index\";\r\nname 1 \"index\";\r\n}
    ; # because I love it so, but it can be build with OTMaster or Makeotf only. (That
    is AFDKO 2.5 syntax.)\r\nlookup Index {\r\nsub bracketleft @figures' bracketright
    by @figures_mono;\r\nsub bracketleft @figures @figures @figures' bracketright
    by @figures_multiple;\r\nsub bracketleft @figures @figures' bracketright by @figures_multiple;\r\nsub
    @figures @figures' figures_multiple by @figures_multiple;\r\nsub @figures' figures_multiple
    by @figures_multiple;\r\nsub bracketleft' @figures_multiple @figures_multiple
    @figures_multiple by bracketleft.rectangle;\r\nsub bracketleft' [@figures_mono
    @figures_multiple] by bracketleft.quadrat;\r\nsub [@figures_mono @figures_multiple]
    bracketright' by bracketright.EmptyAndZeroWidth;} Index;\r\n} ss01;</code>\r\n\r\n<code>feature
    ss02 {\r\nfeatureNames {\r\nname \"index invers\";\r\nname 1 \"index invers\";\r\n}
    ; # because I love it so, but it can be build with OTMaster or Makeotf only. (That
    is AFDKO 2.5 syntax.)\r\nlookup Index;\r\nsub bracketright.EmptyAndZeroWidth by
    bracketright.verticalStroke;\r\nsub bracketleft.rectangle by bracketleft.verticalStroke;\r\nsub
    bracketleft.quadrat by bracketleft.verticalStroke;\r\nsub [@figures_mono @figures_multiple]
    by [@figures_mono_invers @figures_multiple_invers];\r\n} ss02;</code>\r\n"
  created: '2010-06-25 18:53:32'
- author:
    name: Frode Bo Helland
    picture: 112295
  body: "Arno, thanks so much for helping me out. I will test these as soon as possible.
    I want to understand what I\u2019m doing, not just copy someone\u2019s code. Lookups:
    I\u2019m far from an OT-wiz, the lookups just seemed like the best way to solve
    my problem \u2014 they are the closest thing to if/else statements.\r\n\r\nWhat
    do you mean by \u201Cthe order is the same in @figures and @figures_Multiple\u201D?"
  created: '2010-06-25 22:38:16'
- author:
    name: Igor Freiberger
    picture: 115255
  body: "<strong>Lookups: </strong> they are used to organize the code. Although you
    can use a unique sequence of substitutions, to group them into lookpus avoid mess.\r\n\r\n<strong>Same
    order :</strong> when you replace a class with other, OT engine uses the order
    of the glyphs in the class to make substitutions. Example:\r\n<code>\r\nclass
    @this: a e i o u\r\nclass @that: \xE4 \xEB \xEF \xF6 \xFC\r\n</code>\r\nWhen you
    do a command like  <code>sub @this by @that</code>,  if OT engine finds u in your
    text, it will replace this u by the glyph in the same position from the class
    @that. In this example, the 5th character, \xFC.\r\n\r\n<strong>Commented code
    :</strong> here is the code I posted above with some comments. When inserting
    this in your font, you can remove the lines with #.\r\n<code>\r\nfeature ss01
    {\r\n lookup figthree {\r\n</code>\r\n# We must always begins with the more long/complex
    situation.\r\n# In your code, this is the [XXX] case, with three digits.\r\n#
    The reason is the same to text substitution: in a text editor, if you first\r\n#
    replace 'type' with 'font' and later tries to find 'typeface', you get\r\n# a
    problem as 'typeface' became 'fontface' due to the first substitution.\r\n<code>\r\n
    \ sub bracketleft @figures @figures @figures' by @figures_multiple;\r\n } figthree;\r\n</code>\r\n#
    This replaces the thrid digit when there is [XXX. This digit will be\r\n# the
    equivalent one from your figures_multiple class.\r\n<code>\r\nlookup figtwo {\r\nsub
    bracketleft @figures @figures' by @figures_multiple;\r\n} figtwo;\r\n</code>\r\n#
    The same above, now with two digits after [.\r\n# At this moment, we already replaced
    all occurrencies of [XX<strong>X</strong> and [X<strong>X</strong>.\r\n# Every
    digit in these positions came from @figures_multiple at this\r\n# point. We still
    have to substitute [X, the first digit. But in this case,\r\n# there are two possibilities:
    cases where you want a figure_multiple in the \r\n# place of X and cases where
    you want a figure_mono, the [X].\r\n# So we need two commands to handle this.\r\n<code>\r\nlookup
    figone {\r\nsub bracketleft @figures' @figures_multiple by @figures_multiple;\r\n}
    figtone;\r\n</code>\r\n# This is the solution: as [XXX] and [XX] were already
    replaced\r\n# with digits from the @figures_multiple class, every\r\n# [X followed
    with a multiple is not a [X] case, but [XX] or [XXX].\r\n# This simplifies the
    code and reduces the number of procedures.\r\n<code>\r\nlookup figmono {\r\nsub
    bracketleft @figures' backetright by @figures_mono;\r\n} figmono;\r\n</code>\r\n#
    Finally, we replace the remaining [X] with the mono figures.\r\n<code>\r\nlookup
    left {\r\nsub bracketleft' @figures_multiple by bracketleft.square;\r\nsub bracketleft'
    @figures_mono by bracketleft.square;\r\n} left;\r\n</code>\r\n# This replaces
    the bracketleft. Note you have two situations: brackets \r\n# followed by multiple
    and mono digits, so both of them are addressed.\r\n<code>\r\nlookup right {\r\nsub
    @figures_multiple bracketright' by bracketright.square;\r\nsub @figures_mono bracketright'
    by bracketright.square;\r\n} right;\r\n</code>\r\n# Exactly the same we made with
    bracketlefts, now we did with bracketrigths.\r\n<code>\r\n} ss01;\r\n</code>\r\n#
    To close the Stylistic Set.\r\n\r\nNote this order lets you ignore the bracketright
    when doing digit replacement. This also lets your code smaller and more clean.
    Hope this helps."
  created: '2010-06-25 23:13:25'
- author:
    name: Arno Enslin
    picture: 117576
  body: "@ Frode\r\n\r\n<cite>What do you mean by \u201Cthe order is the same in @figures
    and @figures_Multiple\u201D?</cite>\r\n\r\nFreiberger answered in the post above.\r\n\r\n<cite>And,
    another question while I\u2019m at it. If I kern a glyph to overlap another, is
    there some way to make sure the overlap will be knocked out? It\u2019s easily
    done with multiple shapes inside a glyph (ex: the inner shape of O is knocked
    out of the outer).</cite>\r\n\r\nSomehow I have misunderstood that question. You
    want to knockout paths of two <em>different</em> glyphs. This may work in some
    applications, but for sure not in all. I tried something similar <strong><a href=\"http://typophile.com/node/59648\">here</a></strong>
    with a shape, that had the wrong path direction. I thought, that this shape would
    not be visible. So I assume, that you have to provide two sets of invers figures,
    mono_invers and multiple_invers.\r\n\r\nThe other problem, that you had, are rounding
    inaccuracies. And I assume, that they are partly caused by the hinting. I think,
    that can be avoided only, if you let the glyphs overlap with the help of negative
    sidebearings or kerning with the intention, that the overlapping parts do <strong>not</strong>
    knockout. In other words you could close small vertical wholes with the help of
    overlapping the black shapes. This should work in almost all applications. And
    this behavior of the applications is good, because otherwise you had to shorten
    the serifs instead of a negative kerning for a letter combination like XA in E<strong>XA</strong>MPLE."
  created: '2010-06-26 08:42:38'
- author:
    name: Frode Bo Helland
    picture: 112295
  body: "I did this (kerning = +50 to show the overlapping parts)\r\n[img:sites/default/files/old-images/overlaps_6577.png]\r\nto
    take care of the worst overlap problems. \r\n\r\nAnd here\u2019s an example of
    the rendering.\r\n[img:sites/default/files/old-images/rendering_5336.png]\r\nAs
    you can see, the over- and underlines sometimes disappear and might not land on
    the same vertical position. I guess this is just a hinting issue."
  created: '2010-06-26 11:57:21'
- author:
    name: Arno Enslin
    picture: 117576
  body: "@ Frode\r\n\r\nDo the over- and underlines and the horizontal strokes of
    the brackets lay in alignment zones and are they hinted? Normally that should
    solve the problem."
  created: '2010-06-26 13:11:07'
- author:
    name: Frode Bo Helland
    picture: 112295
  body: "No, they\u2019re not hinted. Guess I should look into it, although I\u2019m
    a little scared too."
  created: '2010-06-26 13:36:16'
- author:
    name: Arno Enslin
    picture: 117576
  body: "<a href=\"http://docs.google.com/View?id=dhnxc5bs_21ggxfqxft\">Adam\u2019s
    new hinting tutorial</a>\r\n\r\n<a href=\"http://typophile.com/files/hinting.pdf\">David
    Lemon\u2019s PostScript hinting tutorial</a>\r\n\r\nWith regard to TrueType hinting
    I actually can not help. But setting alignment zones for PostScript flavored fonts
    and individual hints, is not difficult."
  created: '2010-06-26 17:05:55'
- author:
    name: Frode Bo Helland
    picture: 112295
  body: Could I have double brackets as triggers for the inversed glyphs instead of
    two stylistic sets? I tried that in my first code, but it just changed the innermost
    brackets and numerals leaving the outer intact.
  created: '2010-06-26 23:37:42'
- author:
    name: Igor Freiberger
    picture: 115255
  body: "The way I immediately see to achieve this is to build two sequences of lookups
    (or two large lookups), beginning with all the substitutions with one bracket
    and later including all the substitutions with two brackets. So you don't have
    to use ss02.\r\n\r\nThis procedure works but will cause two substitutions: all
    [nX] will be replaced in the first lookup, including the [ [nX] ]. After this,
    the [ [nX] ] are again replaced. Maybe there is a way to avoid two substitutions
    for [ [nx] ], but I have to check this later.\r\n"
  created: '2010-06-27 01:09:23'
- author:
    name: Frode Bo Helland
    picture: 112295
  body: "Arno and Igor! Thanks a lot for the help.\r\nI understood the OT perfectly
    and when I fixed the typos it worked like a charm. I\u2019m not sure if I get
    why you chose to ignore the bracketright until the end. In my case it doesn\u2019t
    matter much, as my font only contain figures, but if I where to write \u201C[24
    and some text\u2026]\u201D the numbers would still substitute."
  created: '2010-06-27 01:41:30'
- author:
    name: Igor Freiberger
    picture: 115255
  body: "<cite>Why you chose to ignore the bracketright until the end?</cite>\r\n\r\nBecause
    with bracketright you have more situations to replace and have to declare all
    of them:\r\n<code>\r\n[XX<strong>X</strong>]\r\n[X<strong>X</strong>X]\r\n[<strong>X</strong>XX]\r\n[X<strong>X</strong>]\r\n[<strong>X</strong>X]\r\n[<strong>X</strong>]\r\n</code>\r\nWhile
    ignoring the bracketright you reduce the situations:\r\n<code>\r\n[XX<strong>X</strong>\r\n[X<strong>X</strong>\r\n[<strong>X</strong>\r\n[<strong>X</strong>]\r\n</code>\r\nAnd
    the code also becomes smaller (as you ommit bracketright from it)."
  created: '2010-06-27 02:16:14'
- author:
    name: Arno Enslin
    picture: 117576
  body: "@ Freiberger\r\n\r\nYour code also substitutes the first three figures in
    [n], where n is a non-negative integer.\r\n\r\n@ Frode\r\n\r\n<cite>Could I have
    double brackets as triggers for the inversed glyphs instead of two stylistic sets?</cite>\r\n\r\nAt
    the bottom of ss01 instead of ss02-feature:\r\n\r\n<code>sub bracketright.EmptyAndZeroWidth'
    bracketright by bracketright.verticalStroke;\r\nsub bracketleft bracketleft.rectangle'
    by bracketleft.verticalStroke;\r\nsub bracketleft bracketleft.quadrat' by bracketleft.verticalStroke;\r\nsub
    [@figures_mono @figures_multiple] by [@figures_mono_invers @figures_multiple_invers];\r\nsub
    bracketleft' bracketleft.verticalStroke by bracketleft.EmptyAndZeroWidth;\r\nsub
    bracketright.verticalStroke bracketright' by bracketright.EmptyAndZeroWidth;</code>\r\n\r\nBut
    you had to search and replace \"[.[\" by \"[\" and \"].]\" by \"]\", if you later
    decide to reinvert the index. If you use a second feature, you can avoid that.
    A second feature is more comfortable. (Remove the dots between the brackets. The
    board software is shit.)\r\n\r\n\r\n\r\n"
  created: '2010-06-27 10:43:18'
- author:
    name: Arno Enslin
    picture: 117576
  body: "I have to check, if I can call a lookup more than one time in a feature or
    if I can simply repeat a substitution rule. Then I could improve the code (See
    bottom \"Improved, but unchecked, if valid\"). But for the moment this is the
    most elegant, I was able to code. The special cases for the rectangle-brackets
    are removed, because I don\u2019t think, that it was a good idea. The problem
    can be solved better with hinting.\r\n\r\n<code>feature ss01 {\r\nfeatureNames
    {\r\nname \"index\";\r\nname 1 \"index\";\r\n} ; # because I love it so, but it
    can be build with OTMaster or Makeotf only. (That is AFDKO 2.5 syntax.)\r\nlookup
    Index {</code>\r\n\r\n<code># [f] to [f.mono]\r\nsub bracketleft @figures' bracketright
    by @figures_mono;</code>\r\n\r\n<code># [fff] to [f f.multiple f]\r\nsub bracketleft
    @figures @figures' @figures bracketright by @figures_multiple;</code>\r\n\r\n<code>#
    [ff] to [f.multiple f]\r\nsub bracketleft @figures' @figures bracketright by @figures_multiple;</code>\r\n\r\n<code>#
    [f.multiple f] to [f.multiple f.multiple] AND\r\n# [f f.multiple f] to [f f.multiple
    f.multiple]\r\nsub @figures.multiple @figures' by @figures_multiple;</code>\r\n\r\n<code>#
    [f f.multiple f.multiple] to [f.multiple f.multiple f.multiple]\r\nsub @figures'
    figures_multiple by @figures_multiple;</code>\r\n\r\n<code>sub bracketleft' [@figures_mono
    @figures_multiple] by bracketleft.square;\r\nsub [@figures_mono @figures_multiple]
    bracketright' by bracketright.square;\r\n} Index;\r\n} ss01;</code>\r\n\r\n<code>feature
    ss02 {\r\nfeatureNames {\r\nname \"index invers\";\r\nname 1 \"index invers\";\r\n}
    ; # because I love it so, but it can be build with OTMaster or Makeotf only. (That
    is AFDKO 2.5 syntax.)\r\nlookup Index;\r\nsub [@figures_mono @figures_multiple
    bracketleft.square bracketright.square] by [@figures_mono_invers @figures_multiple_invers
    bracketleft.squareInvers bracketright.squareInvers];\r\n} ss02;</code>\r\n\r\n-------------------------\r\n\r\nImproved,
    but unchecked, if valid:\r\n\r\n<code># [f] to [f.mono]\r\nsub bracketleft @figures'
    bracketright by @figures_mono;</code>\r\n\r\n<code># [fff] to [f f f.multiple]\r\nsub
    bracketleft @figures @figures @figures' bracketright by @figures_multiple;</code>\r\n\r\n<code>#
    [ff] to [f f.multiple]\r\nsub bracketleft @figures @figures' bracketright by @figures_multiple;</code>\r\n\r\n<code>#
    [f f.multiple] to [f.multiple f.multiple] AND\r\n# [f f f.multiple] to [f f.multiple
    f.multiple]\r\nsub @figures' figures_multiple by @figures_multiple;</code>\r\n\r\n<code>#
    same rule as above\r\n# [f f.multiple f.multiple] to [f.multiple f.multiple f.multiple]\r\nsub
    @figures' figures_multiple by @figures_multiple;</code>\r\n\r\nAnd I have to check,
    whether a lookup can contain another lookup."
  created: '2010-06-27 15:09:41'
- author:
    name: Frode Bo Helland
    picture: 112295
  body: "\u201CThe special cases for the rectangle-brackets are removed, because I
    don\u2019t think, that it was a good idea.\u201D? I don\u2019t understand. I never
    adressed any rendering problems in the OT code. "
  created: '2010-06-27 15:52:52'
- author:
    name: Arno Enslin
    picture: 117576
  body: I meant the full shaped squares and reactangles and the empty character with
    a width of zero. The latest code, that I posted, is intended to use it in combination
    with hinting.
  created: '2010-06-27 16:09:00'
- author:
    name: Frode Bo Helland
    picture: 112295
  body: "Ok. Yes, I think that\u2019s the better solution as well. No reason to apply
    two different methods."
  created: '2010-06-27 16:54:35'
- author:
    name: Igor Freiberger
    picture: 115255
  body: "<cite>Your code also substitutes the first three figures in [n], where n
    is a non-negative integer.</cite>\r\n\r\nArno, I'm not sure if I understood. This
    is the way it's supposed to act. Or am I missing something?\r\n\r\nThere is the
    possibility to result undesired replacement of cases like [1993: Thing] or [12
    cups]. I said in the post of 24.Jun.2010 9.24pm, this hardly would appears as
    the stylistic set demands character style, GREP style or manual formatting \u2013and
    in all these cases user would apply it just to proper situations.\r\n\r\nFrode
    font has just figures, so this is not an issue here. But for other fonts this
    is possible and the type designer must evaluate if another trigger besides []
    is adequate."
  created: '2010-06-27 17:11:35'
- author:
    name: Frode Bo Helland
    picture: 112295
  body: "Arno, your 2.43 makes no sense to me and your 10.53 does not work. \r\n\r\nIf
    I\u2019ll keep two features, I\u2019ll want both stylistic sets to work on it\u2019s
    own, and as of now they do. I can send you the files if you\u2019d like to look
    at it, but I\u2019m more than happy with the help."
  created: '2010-06-27 17:27:34'
- author:
    name: Arno Enslin
    picture: 117576
  body: "@ Frode\r\n\r\nPM sent."
  created: '2010-06-27 19:44:30'
- author:
    name: Arno Enslin
    picture: 117576
  body: "I got the file. There are indeed bugs. I did forget an @, but that is not
    all. The bracketleft will not be replaced, but at the moment I don\u2019t understand
    why. Enough for today."
  created: '2010-06-27 21:35:51'
- author:
    name: Arno Enslin
    picture: 117576
  body: "I don\u2019t know, why, but the main reason, why it did not work, were the
    missing lookups, that I have added now. I have no explanation for that, but I
    am burning for an answer.<strong> Thanks for the opportunity to learn something
    new! I will improve the code probably tomorrow,</strong> but here it is. It works
    fine. Test it with the string \"[1] [12] [123] [1234] [1 1] [12 12] [123 123]\"
    in FontLab. (I did not change your classes, but I have added them to the feature
    file.) By the way, as far as I know, you should avoid names with two dots like
    seven.mono.inverse because of search and copy functions in PDF. I also will post
    code, that you can use for the calt feature instead of the two ss features.\r\n\r\n<code>@figures=[zero
    one two three four five six seven eight nine];\r\n@figures_mono=[zero.mono one.mono
    two.mono three.mono four.mono five.mono six.mono seven.mono eight.mono nine.mono];\r\n@figures_mono_inverse=[zero.mono.inverse
    one.mono.inverse two.mono.inverse three.mono.inverse four.mono.inverse five.mono.inverse
    six.mono.inverse seven.mono.inverse eight.mono.inverse nine.mono.inverse];\r\n@figures_multiple=[zero.multiple
    one.multiple two.multiple three.multiple four.multiple five.multiple six.multiple
    seven.multiple eight.multiple nine.multiple];\r\n@figures_multiple_inverse=[zero.multiple.inverse
    one.multiple.inverse two.multiple.inverse three.multiple.inverse four.multiple.inverse
    five.multiple.inverse six.multiple.inverse seven.multiple.inverse eight.multiple.inverse
    nine.multiple.inverse];</code>\r\n\r\n<code>feature ss01 {\r\n#featureNames {\r\n#name
    \"index\";\r\n#name 1 \"index\";\r\n#} ; # because I love it so, but it can be
    build with OTMaster or Makeotf only. (That is AFDKO 2.5 syntax.)\r\nlookup Index1
    {</code>\r\n\r\n<code># [f] to [f.mono]\r\nsub bracketleft @figures' bracketright
    by @figures_mono;</code>\r\n\r\n<code># [fff] to [f f.multiple f]\r\nsub bracketleft
    @figures @figures' @figures bracketright by @figures_multiple;</code>\r\n\r\n<code>#
    [ff] to [f.multiple f]\r\nsub bracketleft @figures' @figures bracketright by @figures_multiple;</code>\r\n\r\n<code>#
    [f.multiple f] to [f.multiple f.multiple] AND\r\n# [f f.multiple f] to [f f.multiple
    f.multiple]\r\nsub @figures_multiple @figures' by @figures_multiple;\r\n} Index1;</code>\r\n\r\n<code>lookup
    Index2 {\r\n# [f f.multiple f.multiple] to [f.multiple f.multiple f.multiple]\r\nsub
    @figures' @figures_multiple by @figures_multiple;\r\n} Index2;</code>\r\n\r\n<code>lookup
    Index3 {\r\nsub bracketleft' [@figures_mono @figures_multiple] by bracketleft.square;\r\nsub
    [@figures_mono @figures_multiple] bracketright' by bracketright.square;\r\n} Index3;\r\n}
    ss01;</code>\r\n\r\n<code>feature ss02 {\r\n#featureNames {\r\n#name \"index invers\";\r\n#name
    1 \"index invers\";\r\n#} ; # because I love it so, but it can be build with OTMaster
    or Makeotf only. (That is AFDKO 2.5 syntax.)\r\nlookup Index1;\r\nlookup Index2;\r\nlookup
    Index3;\r\nsub [@figures_mono @figures_multiple bracketleft.square bracketright.square]
    by [@figures_mono_inverse @figures_multiple_inverse bracketleft.square.inverse
    bracketright.square.inverse];\r\n} ss02;</code>"
  created: '2010-06-27 22:29:53'
- author:
    name: Frode Bo Helland
    picture: 112295
  body: "For some reason I\u2019m having problems with Freibergers code from June
    25, 3:13. From my client: \u201Cwhen I change the first number, the whole intelligence
    is lost and I have to start again with [\u2026.]. This does not happen in InDesign,
    obviously MS Word is acting different.\u201D\r\n\r\nAny idea why this happens?"
  created: '2010-06-28 12:58:30'
- author:
    name: Igor Freiberger
    picture: 115255
  body: "Frode, I don't know why Word acts in a different way. It may be doing a 'blind'
    substitution (this is a suppostion, I'm at my job now and cannot test this):\r\n\r\nAfter
    user types [X, OT engine already finds the third case from the code and do the
    replace action. User follow typing XX but the OT engine does not understands the
    text is [XXX now and remains with the substituion already made.\r\n\r\nI <strong>guess</strong>
    this is not an issue to InDesign because it handles GREP styles and paragraph
    composer, so the text is always under evaluation by the program. Word seems not
    to go so far.\r\n\r\nIf this is the situation, the code needs to be changed to
    be Word-compatible. So, the solution is to write a longer code like yours first
    try. The schema is\r\n<code>\r\n[XX<strong>X</strong>]\r\n[X<strong>X</strong>X]\r\n[<strong>X</strong>XX]\r\n[X<strong>X</strong>]\r\n[<strong>X</strong>X]\r\n[<strong>X</strong>]\r\n</code>\r\nTo
    avoid Word to replace [X and mess up things, the code needs to find the whole
    situation, including the bracketright.\r\n\r\nI'll come back to this later, probably
    this night, and then post results here."
  created: '2010-06-28 14:54:48'
- author:
    name: Arno Enslin
    picture: 117576
  body: "@ Frode\r\n\r\nI have an <strong><a href=\"http://typophile.com/node/71723\">attachement
    container now</a>.</strong>\r\n\r\nAll the three feature files are tested in FontLab
    and work as intended there.\r\n<ul>\r\n\t\t\t<li><a href=\"http://typophile.com/files/1_Features%20%5Bss01%20and%20ss02%5D.fea_.txt\">1_Features
    [ss01 and ss02].fea_.txt</a></li>\r\n\t\t\t<li><a href=\"http://typophile.com/files/2_Features%20%5Balternative%20ss01%20and%20ss02%5D.fea_.txt\">2_Features
    [alternative ss01 and ss02].fea_.txt</a></li>\r\n\t\t\t<li><a href=\"http://typophile.com/files/3_Features%20%5Bcalt%5D%20%5Bbased%20on%201%5D.fea_.txt\">3_Features
    [calt] [based on 1].fea_.txt</a></li>\r\n\t\t</ul>\r\n\r\nI did not check, if
    there are problems in Word with my features, but I assume, you are having the
    same problems with my features as with Freiberger\u2019s.\r\n\r\nFurthermore I
    assume, that the problem with Word cannot be solved. Just instinct. But I haven\u2019t
    installed Word, so I can\u2019t help you."
  created: '2010-06-28 20:45:37'
- author:
    name: "Przemys\u0142aw"
  body: "Frode:\r\n<em>From my client: \u201Cwhen I change the first number, the whole
    intelligence is lost and I have to start again with [\u2026.]. This does not happen
    in InDesign, obviously MS Word is acting different.\u201D Any idea why this happens?</em>\r\n\r\nThe
    Microsoftian logic: \"We are one of the creators of the OpenType format, therefore
    we will not support it. Ok, ok, we are pulling your leg, we *will*, but we shall
    make it weird and unpredictable\".\r\n\r\n<em>my font only contain figures</em>\r\n\r\nSo
    why complicate things so much? Especially as you use a stylistic set. I've created
    \ a very simple code and it works in Worn 2010. Here it is:\r\n___\r\n\r\n@cyfry
    = [ zero one two three four five six seven eight nine ];\r\n\r\n@cyfry.mono =
    [ zero.mono one.mono two.mono three.mono four.mono five.mono six.mono seven.mono
    eight.mono nine.mono ];\r\n\r\n@cyfry.multi = [ zero.multi one.multi two.multi
    three.multi four.multi five.multi six.multi seven.multi eight.multi nine.multi
    ];\r\n\r\nfeature ss05 {\r\n### hacks for MS Worn 2010\r\n\r\nlookup cyfry.kwad1
    {\r\nsub @cyfry by @cyfry.mono;\r\n} cyfry.kwad1;\r\n\r\nlookup cyfry.kwad2 {\r\nsub
    bracketleft by bracketleft.simple;\r\nsub bracketright by bracketright.simple;\r\n}
    cyfry.kwad2;\r\n\r\nlookup cyfry.kwad3 {\r\nsub @cyfry.mono' @cyfry.mono by @cyfry.multi;\r\n}
    cyfry.kwad3;\r\n\r\nlookup cyfry.kwad4 {\r\nsub @cyfry.multi @cyfry.mono' by @cyfry.multi;\r\n}
    cyfry.kwad4;\r\n\r\n} ss05;\r\n___\r\n\r\n\r\nand [[http://www.avenned.org/litterae/indexednumerals.avi|a
    short presentation]].\r\n\r\n.\r\n\r\n"
  created: '2010-07-01 20:19:55'
- author:
    name: Arno Enslin
    picture: 117576
  body: "This seems to require, that you select the strings, that you want to change,
    but not the whole text, because otherwise all figures would be substituted. As
    an additional feature it may be senseful, if Word 2010 has no problems with that.
    But the class @cyfry (or @figures) is needed only, if the figures from that class
    are intended to be used. So one could ask, why the font contains standard figures,
    but not only the mono and the multi figures and their inverse counterparts or
    two fonts, one with the mono and the multi figures and one with their counterparts
    or four fonts, in which all figure types are split.\r\n\r\nAnd if your code works
    in Word 10 as an addition, this also should work, shouldn\u2019t it?:\r\n\r\nfeature
    ss06 {\r\n### hacks for MS Worn 2010?\r\n\r\nlookup cyfry.kwad1 {\r\nsub bracketleft
    @cyfry' bracketright by @cyfry.mono;\r\n} cyfry.kwad1;\r\n\r\nlookup cyfry.kwad2
    {\r\nsub @cyfry by @cyfry.multi;\r\n} cyfry.kwad2;\r\n\r\nlookup cyfry.kwad3 {\r\nsub
    [bracketleft bracketright] by [bracketleft.simple bracketright.simple];\r\n} cyfry.kwad3;\r\n\r\n}
    ss06;\r\n\r\nFor the case, that Frode\u2019s client wants to use the ss features,
    he also could select the text after reediting it and turn the features of and
    on. Maybe there is a keyboard shortcut in Word.\r\n\r\nMy Media Player does not
    show your presentation, although it normally supports the format \"avi\". But
    there can be dozens of explanations for that."
  created: '2010-07-01 23:32:32'
date: '2010-06-23 13:07:36'
node_type: forum
title: Automatic indexed numerals

---
