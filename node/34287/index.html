<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Question about vertical metrics | Typophile Archive</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="">
    <meta name="generator" content="Hugo 0.91.2" />
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <link href="/style.css" rel="stylesheet">

    <meta property="og:title" content="Question about vertical metrics" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://typophile.github.io/node/34287/" /><meta property="article:section" content="node" />
<meta property="article:published_time" content="2007-06-07T02:40:43+00:00" />
<meta property="article:modified_time" content="2007-06-07T02:40:43+00:00" />

<meta itemprop="name" content="Question about vertical metrics">
<meta itemprop="description" content=""><meta itemprop="datePublished" content="2007-06-07T02:40:43+00:00" />
<meta itemprop="dateModified" content="2007-06-07T02:40:43+00:00" />
<meta itemprop="wordCount" content="0">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Question about vertical metrics"/>
<meta name="twitter:description" content=""/>

  </head>

  <body class="ma0">

      <header>
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container">
      <a class="navbar-brand" href="/">Typophile Archive</a>
      <button
        class="navbar-toggler"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
  </nav>
</header>
 
    <main role="main">
      
<article class="container">
  <header class="post-header py-3">
    <h1 class="post-title p-name" itemprop="name headline">Question about vertical metrics</h1>
    <p class="text-muted">
              
      <time class="f6 mv4 dib tracked" datetime="2007-06-07T02:40:43Z">June 7, 2007</time>
      
        
          • <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">
            <a href="/?q=author:kiko">
            kiko
	    </a>
        </span></span>
      

    </p>
  </header>
  <div class="post-content e-content" itemprop="articleBody"><p>hello people from typophile</p>
<p>I have a question concerning baseline to baseline distance definition or line spacing,
Simply, can that be controled using the typo line gap value?
Does the upm value, also has to be concidered in this task?
i´m a little bit confused on this&hellip;</p>
<p>p.s Working with FL5, at 1000 upm, for outputing a OT-type1 font file</p>
<p>Thanks in advance
Seeya</p>
</div>

  
   <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p><em>OT-type1</em></p>
<p>I presume by this you mean a PostScript OTF font, i.e. an OpenType font with CFF PostScript outline format. [Type 1 is a different species of PostScript font.]</p>
<p>The answer to your question is a little bit complex, because it depends on what application on what operating system you are looking at.</p>
<p>Some applications by default give explicit control of baseline-to-baseline distance to the user, e.g. InDesign and other professional design applications. So we can ignore these.</p>
<p>Other applications make use of the font vertical metrics settings in the OS/2 and hhea tables to determine baseline-to-baseline distance (and also baseline-to-text-block-top for the first line of text). Windows applications use the OS/2 table metrics. Mac applications use the hhea table metrics. I&rsquo;m guessing that most Linux apps used the Os/2 table metric, but I have not confirmed this.</p>
<p>Let&rsquo;s get the Mac apps out of the way first, since this is relatively straightforward. If you sum the values of the hhea Ascender, Descender and LineGap metrics (treating the descender as a positive value), that gives you your gross default baseline-to-baseline distance. I say gross, because of course this value gets rounded to device dependent resolutions. The only tricky thing on the Mac side is that different applications calculate baseline-to-text-block-top for the first line of text differently: some use the Ascender value, some use the Ascender+LineGap value.</p>
<p>On the Windows side, it is a bit more complicated, because the OS/2 table includes two different sets of vertical metrics: Typo metrics and Win metrics. The original idea was that the Typo metrics would control line distance (and hence should be compatable with the corresponding hhea metrics for cross-platform compatibility), and the Win metrics would determine the clipping zone, i.e. the area beyond which parts of glyphs might be clipped by the rendering system. By making the linespacing and clipping zones independent, one could conceivably set them in such a way that e.g. unclipped portions of some letters might intrude into the linespace of adjacent lines. Unfortunately, having elements of text on one line intrude into the vertical space of adjacent lines causes major issues for text refresh, so in practice Windows application developers have ignored the Typo metrics and based both clipping and linespacing on the Win metrics. It is only very recently, in Office 2007, that Microsoft have introduced a mechanism to force the application to base linespacing on the Typo metrics independently of the Typo metrics, but this currently only works ideally in the math equation layout mode in Office 2007; elsewhere, Office assumes the clipping zone to be equal to the sum of the Typo metrics, which simply reverses the old assumption (!)</p>
<p>For more information about font metrics settings and recommended practices, see here:</p>
<p><a href="http://typophile.com/wiki/Vertical%20Metrics%20How-To">http://typophile.com/wiki/Vertical%20Metrics%20How-To</a></p>
<p>Be sure to read all the way to the end, because there are some update notices on best practices.</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2007-06-08 04:59:56"
			itemprop="datePublished"
		>
			2007-06-08 04:59:56
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:John&#43;Hudson">
            John Hudson
	    </a>
			</span></span>
	</div>
	 <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>John,
to add to your summary, WPF honors the new selection bit 7 when calculating line spacing, i.e. it will use the typo metrics when the bit is set.</p>
<p>Best regards,
Mikhail Leonov
Microsoft</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2007-06-15 22:52:48"
			itemprop="datePublished"
		>
			2007-06-15 22:52:48
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:Mikhail&#43;Leonov">
            Mikhail Leonov
	    </a>
			</span></span>
	</div>
	
</div>
 
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>yes, a OpenType font with CFF PostScript outline format.
I´ll check out that info&hellip;</p>
<p>Tanks a lot,
Seeya</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2007-06-08 16:30:13"
			itemprop="datePublished"
		>
			2007-06-08 16:30:13
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:kiko">
            kiko
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">That&rsquo;s good to know, Mikhail. When you say that WPF honours the selection bit 7 setting, what does this imply about clipping for you? Is clipping still associated with the Win values? i.e. is it possible for unclipped text to extend beyond the Typo metrics values in WPF?</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2007-06-18 04:57:21"
			itemprop="datePublished"
		>
			2007-06-18 04:57:21
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:John&#43;Hudson">
            John Hudson
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">John, WPF honors the bit 7 when it calculates line spacing values. Unlike GDI, WPF Text system itself does not clip text, and we discourage our customers from doing this, as it often breaks good typography. Of course, in practice various controls built on top of the WPF text system usually clip all primitives against their own bounds, but in general you should see significantly less, if any, text clipping happening in WPF.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2007-06-18 18:00:19"
			itemprop="datePublished"
		>
			2007-06-18 18:00:19
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:Mikhail&#43;Leonov">
            Mikhail Leonov
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>I gather that Office 2007 honors bit 7, however unlike WPF it uses GDI and thus clips to the new line spacing. Ewww.</p>
<p>T</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2007-06-18 18:25:49"
			itemprop="datePublished"
		>
			2007-06-18 18:25:49
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:Thomas&#43;Phinney">
            Thomas Phinney
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>Bit 7 released windows metrics from playing double role of clipping and line spacing (and preserve compatibility for legacy applications at the same time). This is what&rsquo;s happening in Cambria Math: typo metrics set line height to 2400 units and win metrics to over 11000, so no clipping happens inside GDI even if default line height is much smaller.</p>
<p>Using GDI is not reason for clippng in Word. Problem is that they are  clipping text by iteself to actual line height. If you increase line spacing, area clipped by Word will expand. This is legacy of old Word layout/drawing code, not GDI. Same may happen if they switch to WPF without changing this old code. As you can see in Mikhail&rsquo;s post, WPF standard controls will clip on their own too, so this is not limitation of glyph rendering code. Another (positive) example is math layout code in Word, which is new and does not clip high glyphs.</p>
<p>Thanks,
Sergey</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2007-06-18 20:01:42"
			itemprop="datePublished"
		>
			2007-06-18 20:01:42
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:sergeym">
            sergeym
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>Thanks for the extra information, Mikhail. Am I correct in assuming that WPF also intelligently handles line refresh, so that artifacts outside the line height are not left onscreen when text is edited? As I understand it, this is one of the concerns about allowing visible glyph shapes to extend beyond the line height.</p>
<p>[PS. I&rsquo;ll be in Redmond next week, Mikhail, and mentioned to Geraldine Wade that I&rsquo;d like to meet you if you are around.]</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2007-06-19 05:00:36"
			itemprop="datePublished"
		>
			2007-06-19 05:00:36
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:John&#43;Hudson">
            John Hudson
	    </a>
			</span></span>
	</div>
	 <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>John,
the WPF rendering system handles refreshes by keeping track of dirty regions. Dirty region bounding boxes are computed using individual glyph black box metrics, and no font-wide values are used for that purpose.</p>
<p>Yes, you are very welcome to stop by. My email is Mikhail.Leonov at (trying to prevent spam by spelling it out) microsoft dot com.</p>
<p>Best regards,
Mikhail</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2007-06-19 18:12:45"
			itemprop="datePublished"
		>
			2007-06-19 18:12:45
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:Mikhail&#43;Leonov">
            Mikhail Leonov
	    </a>
			</span></span>
	</div>
	
</div>
 
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>By the way, is anyone aware of fonts that have positive sTypoDescender instead of the usual negative value? The dilemma for a font engine or for an application is whether to attempt to &ldquo;correct&rdquo; the inverted descent by changing its sign (assuming a font defect), or exposing the positive descent value (assuming intentional font vendor decision) and leaving it up to the application to determine what it means in the context of text layout.</p>
<p>I was told some time ago that superscript only fonts may decide to do this, but I&rsquo;m not sure how this plays with usWinAscent accepting only unsigned values.</p>
<p>Thanks in advance,
Mikhail</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2007-06-26 01:25:39"
			itemprop="datePublished"
		>
			2007-06-26 01:25:39
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:Mikhail&#43;Leonov">
            Mikhail Leonov
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Spam is spam, even in Arabic.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2010-02-22 02:56:24"
			itemprop="datePublished"
		>
			2010-02-22 02:56:24
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:lunde">
            lunde
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>Mikhail: I believe I remember some of Adobe&rsquo;s engineers encountering inconsistent descender pos/neg issues of the sort you describe. You might want to ping Sairus (sppatel) or somebody on the CoolType team.</p>
<p>Regards,</p>
<p>T</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2010-02-24 04:33:26"
			itemprop="datePublished"
		>
			2010-02-24 04:33:26
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:Thomas&#43;Phinney">
            Thomas Phinney
	    </a>
			</span></span>
	</div>
	
</div>
 
</article>

    </main>
    
  </body>
</html>
