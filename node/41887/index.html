<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Ligature order | Typophile Archive</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="description" content="">
    <meta name="generator" content="Hugo 0.91.2" />
    
    
    
    
      <meta name="robots" content="noindex, nofollow">
    

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <link href="/style.css" rel="stylesheet">

    <meta property="og:title" content="Ligature order" />
<meta property="og:description" content="" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://typophile.github.io/node/41887/" /><meta property="article:section" content="node" />
<meta property="article:published_time" content="2008-02-09T20:28:53+00:00" />
<meta property="article:modified_time" content="2008-02-09T20:28:53+00:00" />

<meta itemprop="name" content="Ligature order">
<meta itemprop="description" content=""><meta itemprop="datePublished" content="2008-02-09T20:28:53+00:00" />
<meta itemprop="dateModified" content="2008-02-09T20:28:53+00:00" />
<meta itemprop="wordCount" content="0">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Ligature order"/>
<meta name="twitter:description" content=""/>

  </head>

  <body class="ma0">

      <header>
  <nav class="navbar navbar-expand-lg navbar-light bg-light">
    <div class="container">
      <a class="navbar-brand" href="/">Typophile Archive</a>
      <button
        class="navbar-toggler"
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent"
        aria-expanded="false"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
  </nav>
</header>
 
    <main role="main">
      
<article class="container">
  <header class="post-header py-3">
    <h1 class="post-title p-name" itemprop="name headline">Ligature order</h1>
    <p class="text-muted">
              
      <time class="f6 mv4 dib tracked" datetime="2008-02-09T20:28:53Z">February 9, 2008</time>
      
        
          • <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">
            <a href="/?q=author:Dan&#43;Gayle">
            Dan Gayle
	    </a>
        </span></span>
      

    </p>
  </header>
  <div class="post-content e-content" itemprop="articleBody"><p>I&rsquo;m working on a font that has multiple ligs, and I&rsquo;m running into a problem. I have <code>l_l</code> and an <code>e_l</code> ligs, set up like so:</p>
<p><code>sub l l by l_l;</code>
<code>sub e l by e_l;</code></p>
<p>Ostensibly, the order should make the <code>l_l</code> come <em>before</em> the <code>e_l</code>, but this is what I get:</p>
<p><img src="/images/old-images/Picture-2_4400.png" alt=""></p>
<p>Any suggestions?</p>
</div>

  
   <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>The problem is that &lsquo;el&rsquo; in the sequence comes before &rsquo;ll', despite the order written in the feature code.</p>
<p>So that means that I need to write a contextual something or another that says, &ldquo;If the string el is followed by the string ll, do NOT substitute the e_l ligature.&rdquo;</p>
<p>I know it can be done, I just don&rsquo;t know how to do contextual stuff.</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-02-09 22:08:04"
			itemprop="datePublished"
		>
			2008-02-09 22:08:04
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:Dan&#43;Gayle">
            Dan Gayle
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">For now I&rsquo;ve just eliminated the e_l lig, if only temporary.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-02-09 22:08:49"
			itemprop="datePublished"
		>
			2008-02-09 22:08:49
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:Dan&#43;Gayle">
            Dan Gayle
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">why <em>liga</em> and not <em>clig</em>?</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-02-09 22:16:14"
			itemprop="datePublished"
		>
			2008-02-09 22:16:14
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:david&#43;h">
            david h
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>It has nothing to do with contextual stuff. Just replace the l with another l (that looks the same) so that when ell occurs l_l is &lsquo;taken&rsquo; and e_l can no longer be processed.</p>
<p>If you want, I can send you the thing I&rsquo;m working on right now. It covers more or less the  same thing.</p>
<p><img src="/images/old-images/code_4912.png" alt=""></p>
<p><img src="/images/old-images/HTTZ_4996.gif" alt=""></p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-02-09 22:20:29"
			itemprop="datePublished"
		>
			2008-02-09 22:20:29
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:Jos&#43;Buivenga">
            Jos Buivenga
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>That would be cool. dan at dangayle dot com</p>
<p>But the explanation belowy tells why I&rsquo;ll keep looking:</p>
<p>@david hamuel
<cite>why liga and not clig?</cite>
Honestly, I don&rsquo;t know how to use that feature. But I have a semi- script type with about 100 ligs going on, some with alternates, so it might be handy to know. I&rsquo;ve already ran into two situations like this, so a better solution is needed that won&rsquo;t require multiple redundancies.</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-02-09 22:43:42"
			itemprop="datePublished"
		>
			2008-02-09 22:43:42
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:Dan&#43;Gayle">
            Dan Gayle
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><blockquote>
<p>I don’t know how to use that feature. But I have a semi- script type with about 100 ligs going on, some with alternates, so it might be handy to know</p>
</blockquote>
<p>Bickham Script Pro (feature file sample):</p>
<p><a href="http://www.adobeforums.com/webx/.3bb7c828/0">http://www.adobeforums.com/webx/.3bb7c828/0</a></p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-02-09 22:51:40"
			itemprop="datePublished"
		>
			2008-02-09 22:51:40
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:david&#43;h">
            david h
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Dan, ygm. I made a new (FontLab) doc with just your liga thing. I think it works.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-02-09 23:02:47"
			itemprop="datePublished"
		>
			2008-02-09 23:02:47
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:Jos&#43;Buivenga">
            Jos Buivenga
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">** edit ** double post</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-02-09 23:06:44"
			itemprop="datePublished"
		>
			2008-02-09 23:06:44
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:Jos&#43;Buivenga">
            Jos Buivenga
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>Although Jos' approach also works, Dan is quite right to say that this can be solved by contextual code, too. Personally, I&rsquo;d consider that simpler and more elegant than adding an extra glyph, though both approaches work.</p>
<p>So, you want the l_l ligature to take precedence over the e_l ligature. There are probably at least three ways to do this in AFDKO/FontLab code. Here&rsquo;s one:</p>
<p>ignore sub e' l' l
sub e l by e_l
sub l l by l_l</p>
<p>(Note: I haven&rsquo;t time to test this right now, but I <em>think</em> it should have the desired effect.</p>
<p>Cheers,</p>
<p>T</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-02-09 23:15:17"
			itemprop="datePublished"
		>
			2008-02-09 23:15:17
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:Thomas&#43;Phinney">
            Thomas Phinney
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Thomas, that would be an elegant solution. I was not familiar with this &lsquo;ignore command&rsquo; so I&rsquo;ve tried this, but I really can&rsquo;t get it to work.</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-02-09 23:31:38"
			itemprop="datePublished"
		>
			2008-02-09 23:31:38
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:Jos&#43;Buivenga">
            Jos Buivenga
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>You do not necessarily need contextuality. You could as well use two (or more) lookups to get the same effect:</p>
<p>In a first step, create a lookup explicitly and put your substitution statements into it. In the example below, this would be the &ldquo;thenThese&rdquo; lookup. If, in your tests, you find that particular statements should have priority but are not executed because others interfere, create another lookup above the existing one, then place the higher-priority substitutions in it. In the example, this is the &ldquo;theseFirst&rdquo; lookup. I think two or a maximum of three lookups should do, it depends how complex matters are in your font:</p>
<p>    lookup calt {
       lookup theseFirst {
          sub l l by l_l;
       } theseFirst;
       lookup thenThese {
          sub e l by e_l;
       } thenThese;
    } calt;</p>
<p>Your test word suggests that these ligatures are essential part of the design rather than optional, i.e. there is no need to allow a user to switch them on/off. In so far &lsquo;calt&rsquo; is a good choice. Also, &lsquo;clig&rsquo; is one of the features which different applications <em>may</em> handle differently (either in a UI option of its own, or bundled with another feature in a common UI option), so it may be safer to avoid such features where possible. (This is a personal comment. Others may disagree.)</p>
<p>What&rsquo;s missing in the &lsquo;ignore&rsquo; example is that following substitutions need to be contextual too:</p>
<p>    lookup calt {
       ignore sub e' l' l;
       sub e' l' by e_l;
       sub l' l' by l_l;
    } calt;</p>
<p>(This is one of my most frequent errors &hellip;) However, for some reason this still doesn&rsquo;t work in the FLS preview. Haven&rsquo;t tested with a compiled font yet.</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-02-10 00:34:17"
			itemprop="datePublished"
		>
			2008-02-10 00:34:17
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:k.l.">
            k.l.
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>Ok, got it. Despite the ignore statement you&rsquo;d still need two separate lookups:</p>
<p>    feature calt {
       lookup standardWithExclusion {
          ignore sub e' l' l;
          sub e' l' by e_l;
       } standardWithExclusion;
       lookup highPriority {
          sub l' l' by l_l;
       } highPriority;
    } calt;</p>
<p>Note that in contrast to the first example in my last post, the lookup with standard substitutions is the first (not last) one. First, the ignore statement in the first lookup makes sure that e l is <em>not</em> substituted by the e_l ligature if another l follows. Then, the second lookup is applied to the text string which still contains individual l l and can substitute these by the l_l ligature.
While the ignore statement can be pretty powerful, in your case it complicates matters more than necessary because for every substitution in the &ldquo;highPriority&rdquo; lookup, you would need to add an according ignore statement to the &ldquo;standardWithExclusion&rdquo; lookup.</p>
<p>Karsten</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-02-10 00:56:50"
			itemprop="datePublished"
		>
			2008-02-10 00:56:50
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:k.l.">
            k.l.
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>Wow. Karsten, I have NO IDEA what any of that means :)</p>
<p>Well, I understand a little. I just don&rsquo;t understand the why.</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-02-10 01:09:35"
			itemprop="datePublished"
		>
			2008-02-10 01:09:35
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:Dan&#43;Gayle">
            Dan Gayle
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>The first example,</p>
<p>lookup theseFirst {
sub l l by l_l;
} theseFirst;
lookup thenThese {
sub e l by e_l;
} thenThese;</p>
<p>worked.
<img src="/images/old-images/Picture-2_5876.gif" alt=""></p>
<p>The others wouldn&rsquo;t compile, giving me:</p>
<p><img src="/images/old-images/Picture-3_4477.gif" alt=""></p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-02-10 02:46:08"
			itemprop="datePublished"
		>
			2008-02-10 02:46:08
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:Dan&#43;Gayle">
            Dan Gayle
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>I can&rsquo;t begin to write code like you guys. But one tiny note: While &ldquo;calt&rdquo; is on by default, with InDesign, anyway, I believe you can turn it off, using the paragraph styles &gt; OT features menu. If you turn it off with the basic paragraph, all paragraph styles based on that will also have calt off.</p>
<p>Still, it is usually a good idea to make the comp take a conscious action rather than to depend on him/her to <em>remember</em> to take action. If you as the designer feel they should be on, put them in calt &amp; make the comp do work to not use them.</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-02-10 04:24:16"
			itemprop="datePublished"
		>
			2008-02-10 04:24:16
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:charles&#43;ellertson">
            charles ellertson
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>In the code, you need to replace quoteright/quoteleft by simple quotes. Typophile is just too smart &hellip;</p>
<p>Indeed, while &lsquo;calt&rsquo;/&lsquo;liga&rsquo; are currently the best choices for substitutions to be on by default, they still can be switched off. Oh, and I must have been sleeping yesterday: since no contextuality is involved, &lsquo;liga&rsquo; is it.</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-02-10 10:30:42"
			itemprop="datePublished"
		>
			2008-02-10 10:30:42
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:k.l.">
            k.l.
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>In OpenType Layout, each font has a list of little procedures called <b>lookups</b>. Those lookups are assigned to layout features. Typically, in simple Western OpenType fonts, one lookup is assigned to just one feature. But you also can have several lookups being assigned to one feature, and also one lookup being assigned to several features.</p>
<p>It is important to realize that there are two separate lists of things in the font: one is a list of lookups and the other is a list of features (there is also the issue of languagesystems but I won&rsquo;t discuss it here). And then there are just mappings between those. The Adobe FDK for OpenType (AFDKO) syntax for writing OpenType Layout feature definitions, used by AFDKO itself as well as FontLab Studio and DTL FontMaster, hides this fact and makes you believe that you define the &ldquo;action code&rdquo; inside of feature definitions:</p>
<p><code># AFDKO 1.6 / FontLab Studio 5 syntax</code></p>
<p><code>feature liga {
sub l l by l_l;
sub f i by f_i;
} liga;</code></p>
<p><code>feature swsh {
sub f by f.swsh; 
} swsh;</code></p>
<p>This is a simplified notation of the following:</p>
<p><code># AFDKO 1.6 / FontLab Studio 5 syntax</code></p>
<p><code>feature liga {
lookup L1 {
sub l l by l_l;
sub f i by f_i;
} L1;
} liga;</code></p>
<p><code>feature swsh {
lookup L2 {
sub f by f.swsh; 
} L2;
} swsh;</code></p>
<p>So here, we have one lookup <code>liga1</code> that is assigned to the <code>liga</code> feature. If one lookup is assigned to just one feature, the AFDKO feature syntax allows omitting the <code>lookup</code> statement. But it is important to realize that it is still there, implicitly.</p>
<p>Actually, a more precise representation of how this information is represented in the font would be the following:</p>
<p><code># AFDKO 2.0-only / future FontLab Studio 6-only syntax</code></p>
<p><code># Lookups</code></p>
<p><code>lookup L1 {
sub l l by l_l;
sub f i by f_i;
} L1;</code></p>
<p><code>lookup L2 {
sub f by f.swsh;
} L2;</code></p>
<p><code># &hellip;</p>
<h1 id="featurescode">Features</code></h1>
<p><code>feature liga {
lookup L1;
} liga;</code></p>
<p><code>feature swsh {
lookup L2;
} swsh;</code></p>
<p>The lookup names (L1, L2) do not matter because they are not written into the font. Internally, lookups are just identified by numbers. You also can have several lookups being assigned to one feature:</p>
<p><code># AFDKO 1.6 / FontLab Studio 5 syntax</code></p>
<p><code>feature liga {
lookup L1 {
sub l l by l_l;
sub f i by f_i;
} L1;
lookup L3 {
sub e l by e_l;
} L3;
} liga;</code></p>
<p>Internally, this would be written into the font as:</p>
<p><code># AFDKO 2.0-only / future FontLab Studio 6-only syntax</code></p>
<p><code># Lookups</code></p>
<p><code>lookup L1 {
sub l l by l_l;
sub f i by f_i;
} L1;</code></p>
<p><code>lookup L3 {
sub e l by e_l;
} L3;</code></p>
<p><code># Features</code></p>
<p><code>feature liga {
lookup L1;
lookup L3;
} liga;</code></p>
<p>You can also have one lookup being assigned to several features:</p>
<p><code># AFDKO 1.6 / FontLab Studio 5 syntax</code></p>
<p><code>feature liga {
lookup L1 {
sub l l by l_l;
sub f i by f_i;
} L1;
} liga;</code></p>
<p><code>feature calt {
lookup L1;
} calt;</code></p>
<p>This corresponds to the internal structure:</p>
<p><code># AFDKO 2.0-only / future FontLab Studio 6-only syntax</code></p>
<p><code># Lookups</code></p>
<p><code>lookup L1 {
sub l l by l_l;
sub f i by f_i;
} L1;</code></p>
<p><code># Features</code></p>
<p><code>feature liga {
lookup L1;
} liga;</code></p>
<p><code>feature calt {
lookup L1;
} calt;</code></p>
<p>In text formatting using OpenType Layout, each line of text is divided into &ldquo;runs&rdquo; of text that have the same formatting (i.e. font and combination of enabled OpenType Layout features) and directionality. In a typical European text, each line of text is just one &ldquo;run&rdquo;, but if you have Arabic or Hebrew with interspersed European numerals or European phrases, those would be separate runs.</p>
<p>Each run has a certain combination of features that will be applied to it (controlled by the user, e.g. <code>dlig</code>, as well as those that the layout engine applies automatically, e.g. <code>ccmp</code>). When the text is being displayed, each run is typeset using the default glyphs representing the text&rsquo;s characters (i.e. the glyphs that have Unicode codepoints assigned for those characters). Then, for some Asian scripts, special glyph reordering is being done (but not for European scripts). And then, the list of lookups is retrieved for the combination of features that are being applied.</p>
<p>So if I have a font with the OpenType Layout code defined as follows:</p>
<p><code># AFDKO 2.0-only / future FontLab Studio 6-only syntax</code></p>
<p><code># Lookups</code></p>
<p><code>lookup L1 {
sub l l by l_l;
sub f i by f_i;
} L1;</code></p>
<p><code>lookup L2 {
sub f by f.swsh;
} L2;</code></p>
<p><code>lookup L3 {
sub e l by e_l;
} L3;</code></p>
<p><code># Features</code></p>
<p><code>feature liga {
lookup L1;
lookup L3;
} liga;</code></p>
<p><code>feature swsh {
lookup L2;
} swsh;</code></p>
<p><code>feature calt {
lookup L1;
} calt;</code></p>
<p>And the features <code>liga</code>, <code>swsh</code> and <code>calt</code> are all applied to the text, then the OpenType Layout engine retrieves the list of the lookups associated with all those features (i.e. <code>L1</code>, <code>L2</code> and <code>L3</code>), and applies them.</p>
<p>The lookups are applied one after another to the entire run of text in the sequence the lookups have been defined in the font. So in the above example, first the lookup <code>L1</code> is applied to the default string of glyphs (because it is assigned to the <code>liga</code> and <code>calt</code> features). Let&rsquo;s assume that the user typesets the following text:</p>
<p><em>Hellenic figure</em></p>
<p>So the default series of glyphs in the run would be:</p>
<p><code>H e l l e n i c space f i g u r e</code></p>
<p>The lookup <code>L1</code> is &ldquo;executed&rdquo; on the run. It replaces the glyph sequence <code>l l</code> with the glyph <code>l_l</code> and it replaces the glyph sequence <code>f i</code> with the glyph <code>f_i</code>. So after the lookup as been applied, the glyph run looks like this:</p>
<p><code>H e l_l e n i c space f_i g u r e</code></p>
<p>Then, the lookup <code>L2</code> referenced by the <code>swsh</code> is applied to the glyph run. It replaces the glyph <code>f</code> with the glyph <code>f.swsh</code>. This does not produce any change in the text because the glyph <code>f</code> is not present in the glyph run anymore (as the <code>L1</code> lookup replaced it).</p>
<p>Finally, the lookup <code>L3</code> is executed. It replaces the glyph sequence <code>e l</code> with the glyph <code>e_l</code>. This does not produce any change either, because the glyph sequence <code>e l</code> is not in the glyph run (we have the glyph sequence <code>e l_l</code>, but that&rsquo;s completely different).</p>
<p>So the final product of the processing is:</p>
<p><code>H e l_l e n i c space f_i g u r e</code></p>
<p>What if I change the order of the lookups defined in my font?</p>
<p><code># AFDKO 2.0-only / future FontLab Studio 6-only syntax</code></p>
<p><code># Lookups</code></p>
<p><code>lookup L2 {
sub f by f.swsh;
} L2;</code></p>
<p><code>lookup L3 {
sub e l by e_l;
} L3;</code></p>
<p><code>lookup L1 {
sub l l by l_l;
sub f i by f_i;
} L1;</code></p>
<p><code># Features</code></p>
<p><code>feature liga {
lookup L1;
lookup L3;
} liga;</code></p>
<p><code>feature swsh {
lookup L2;
} swsh;</code></p>
<p><code>feature calt {
lookup L1;
} calt;</code></p>
<p>Then, the lookup <code>L2</code> will be first applied to my default glyph run <code>H e l l e n i c space f i g u r e</code>. It replaces the glyph <code>f</code> with the glyph <code>f.swsh</code>, so after the first lookup has been applied, the glyph run looks like the following:</p>
<p><code>H e l l e n i c space f.swsh i g u r e</code></p>
<p>Now the lookup <code>L3</code> is applied, changing the glyph sequence <code>e l</code> into the glyph <code>e_l</code>, so the result is:</p>
<p><code>H e_l l e n i c space f.swsh i g u r e</code></p>
<p>Finally, the lookup <code>L1</code> is executed. It tries to replace the glyph sequence <code>l l</code> with the glyph <code>l_l</code> and the glyph sequence <code>f i</code> with the glyph <code>f_i</code>. None of those replacements will be carried out because those glyph sequences are no longer in the glyph run. So the final result of our processing is:</p>
<p><code>H e_l l e n i c space f.swsh i g u r e</code></p>
<p>Of course if only some feature were applied, e.g. only <code>calt</code> or only <code>calt</code> and <code>liga</code> but no <code>swsh</code>, only the appropriate lookups would be executed — but always in the sequence in which they are defined in the font.</p>
<p>Note that in FontLab Studio, you cannot currently define the lookups outside of feature definitions. The lookups are defined inside of the feature definitions — explicitly using the <code>lookup</code> keyword or implicitly by just writing the substitution statements. When the AFDKO code is compiled into binary OpenType Layout tables, the lookups are compiled and stored in the font in the sequence they have been defined in the syntax, i.e. in the sequence the feature have been defined. So by reordering the features in the OpenType panel of FontLab Studio you actually change the order in which the lookups will be stored in the font.</p>
<p>This is extremely important for feature interaction. If you have one lookup that replaces the <code>f</code> glyph with the smallcap <code>f.smcp</code> glyph (this lookup is mapped to the <code>smcp</code> feature), and you have a lookup that replaces the glyph sequence <code>f i</code> by the glyph <code>f_i</code> (that lookup is used by the <code>liga</code> feature), you want to make sure that, when both features are applied, the smallcap lookup is executed first. Otherwise, you&rsquo;d end up with a lonely <code>f_i</code> ligature sticking out of an all-smallcaps text. And the FontLab Studio method to make sure that the smallcap lookup is executed first is to place the <code>smcp</code> feature definition before the <code>liga</code> feature definition in the OpenType panel.</p>
<p>The task of writing good OpenType Layout feature definitions becomes somewhat challenging when you have complex feature definitions that involve many lookups, and you have a potentially large number of different interacting features.</p>
<p>I recommend reading this article by John Hudson for further understanding of how OpenType Layout works: 
<a href="http://www.microsoft.com/typography/Glyph%20Processing/intro.mspx">http://www.microsoft.com/typography/Glyph%20Processing/intro.mspx</a></p>
<p>Regards,
Adam</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-02-10 11:02:12"
			itemprop="datePublished"
		>
			2008-02-10 11:02:12
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:twardoch">
            twardoch
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">[Removed this post &ndash; and changed its position &hellip; &ndash; since Adam&rsquo;s description is <em>much</em> more detailed and exact. What I keep is the link to the <a href="http://www.adobe.com/devnet/opentype/afdko/topic_feature_file_syntax.html" target="_blank">Feature File Syntax</a>.]</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-02-10 16:37:39"
			itemprop="datePublished"
		>
			2008-02-10 16:37:39
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:k.l.">
            k.l.
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody"><p>Wowsers.</p>
<p>Thanks Adam and Karsten!</p>
<p>So, if I have everything right, aside from cutting and pasting Karsten&rsquo;s code above, I should do multiple lookups under the same feature. Then each lookup is applied to the string of text in the order that the lookup is created.</p>
<p>So without cheating by looking, this is how I would accomplish my goal as set out above:</p>
<p><code>feature liga {</code></p>
<p><code>lookup L1 {</code>
<code>sub l l by l_l;</code>
<code>} L1;</code></p>
<p><code>lookup L2 {</code>
<code>sub e l by e_l;</code>
<code>} L2;</code></p>
<p><code>} liga;</code></p>
<p>No need to worry about contextuality then, since this definition makes <code>l_l</code> take precedence over <code>e_l</code> at all times. This is very helpful. Thanks again guys!</p>
</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-02-10 16:57:21"
			itemprop="datePublished"
		>
			2008-02-10 16:57:21
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:Dan&#43;Gayle">
            Dan Gayle
	    </a>
			</span></span>
	</div>
	
</div>
  <div class="comment card m-3">
	<div class="card-body">
		<div class="commentbody">Dan, why not just create an e_l_l ligature as you like it and put it first in order.
Stephen</div>
	</div>
	<div class="card-footer text-muted post-meta text-end">
		<time
			class="dt-published"
			datetime="2008-02-11 16:05:57"
			itemprop="datePublished"
		>
			2008-02-11 16:05:57
		</time>
		•
		<span itemprop="author" itemscope itemtype="http://schema.org/Person">

			<span class="p-author h-card" itemprop="name">
            <a href="/?q=author:Stephen&#43;Rapp">
            Stephen Rapp
	    </a>
			</span></span>
	</div>
	
</div>
 
</article>

    </main>
    
  </body>
</html>
